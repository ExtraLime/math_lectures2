text,start,stop
&gt;&gt; DAVID MALAN: All right.,00:00:11.330,00:00:12.360
"This is CS50, and this is
the end of week nine.",00:00:12.360,00:00:15.970
"It's been a whirlwind over
the past few days.",00:00:15.970,00:00:18.560
"And problem set seven, if you're knee
deep into it, realize there's quite a",00:00:18.560,00:00:21.580
bit new that's in there.,00:00:21.580,00:00:23.340
"But let's see if we can't piece
everything together here briefly",00:00:23.340,00:00:26.660
"before then veering off in yet
another direction and seeing",00:00:26.660,00:00:29.230
where else we can go.,00:00:29.230,00:00:30.510
"&gt;&gt; So thus far, we've talked about HTML.",00:00:30.510,00:00:32.630
We've talked about CSS.,00:00:32.630,00:00:33.740
We've talked about PHP.,00:00:33.740,00:00:34.705
You've started to experience SQL.,00:00:34.705,00:00:36.520
"Today, we'll talk a bit
about JavaScript.",00:00:36.520,00:00:38.360
"But how do all of these disparate
languages fit together?",00:00:38.360,00:00:41.230
"&gt;&gt; So we talked last week about the
notion of having a server.",00:00:41.230,00:00:44.970
"So let's just draw this rectangle
as a web server here.",00:00:44.970,00:00:48.470
And a web server serves surely files.,00:00:48.470,00:00:52.200
"And some of those files
can be HTML files.",00:00:52.200,00:00:54.640
"So one of the things that a web server
can spit out might be a file that",00:00:54.640,00:00:58.270
"we'll just draw like this
containing some HTML.",00:00:58.270,00:01:01.290
"So in layman's terms, what
does HTML let you do?",00:01:01.290,00:01:04.786
&gt;&gt; AUDIENCE: Page look nice.,00:01:04.786,00:01:06.036
"&gt;&gt; DAVID MALAN: OK, make a page look nice,
although I think I've proven",00:01:09.670,00:01:12.310
that otherwise.,00:01:12.310,00:01:13.370
"So HTML does let you lay out pages
structurally, and it allows you to",00:01:13.370,00:01:18.250
"sort of aesthetically mark up a page,
mark up static content, so that you",00:01:18.250,00:01:22.410
can then view it with a web browser.,00:01:22.410,00:01:23.640
&gt;&gt; But that's the key.,00:01:23.640,00:01:24.690
It's static content.,00:01:24.690,00:01:26.130
"You write it, you save it,
and then you ship it.",00:01:26.130,00:01:28.590
"And the web server then serves
it up to your visitors.",00:01:28.590,00:01:31.130
"&gt;&gt; But we stylize things using a different
language altogether.",00:01:31.130,00:01:35.700
"We started to use a style attribute
on certain tags.",00:01:35.700,00:01:40.150
"And the style attribute let us set
things like font size and color.",00:01:40.150,00:01:43.400
"And you've probably started to discover,
or you soon will for final",00:01:43.400,00:01:46.460
"projects potentially, yet other
properties that you can use in CSS.",00:01:46.460,00:01:50.160
"And so in layman's terms, what
really then does CSS do?",00:01:50.160,00:01:54.710
Those are just examples thereof.,00:01:54.710,00:01:57.810
"What does it let you do that HTML
doesn't seem to from what",00:01:57.810,00:02:00.730
we've seen thus far?,00:02:00.730,00:02:02.606
&gt;&gt; AUDIENCE: Define styles by yourself.,00:02:02.606,00:02:04.850
"&gt;&gt; DAVID MALAN: Define styles
by yourself.",00:02:04.850,00:02:06.700
"So define things like classes as you
may have encountered, or uniquely",00:02:06.700,00:02:10.280
"identify nodes in a document so
that you can stylize them.",00:02:10.280,00:02:13.800
"But more specifically, I'd say that CSS
really lets you take things the",00:02:13.800,00:02:16.890
"last mile and allows you to specify much
more precisely the aesthetics,",00:02:16.890,00:02:20.790
"whereas HTML for the most part lets
you structure your pages.",00:02:20.790,00:02:24.340
"&gt;&gt; And even though there are some defaults,
like we saw the  tag for",00:02:24.340,00:02:27.310
"a heading tag, which roughly speaking
made things big and bold.",00:02:27.310,00:02:30.690
"That's a pretty generic definition
of the  tag-- big and bold.",00:02:30.690,00:02:34.250
What font size is that?,00:02:34.250,00:02:35.260
What color is that?,00:02:35.260,00:02:36.080
How bold is that?,00:02:36.080,00:02:36.890
"And CSS lets you more finely
tune things like that.",00:02:36.890,00:02:39.830
"As well as layout, as some
of you have seen.",00:02:39.830,00:02:42.150
"&gt;&gt; And frankly, CSS is a bit
of a messy language.",00:02:42.150,00:02:45.180
"It's very powerful in that you can make
literally any website that you've",00:02:45.180,00:02:48.370
"seen on the web today with it, but
it's kind of a pain in the neck.",00:02:48.370,00:02:51.880
"And some of you have banged your head
against the walls already just to do",00:02:51.880,00:02:54.440
"something stupid like center a menu on
problem set seven if you've gotten to",00:02:54.440,00:02:58.560
that point already.,00:02:58.560,00:02:59.470
"&gt;&gt; But realize, those things
get easier over time.",00:02:59.470,00:03:01.530
You start to notice patterns.,00:03:01.530,00:03:02.820
"And again, Google will be your friend
for the various ways in which you can",00:03:02.820,00:03:06.020
solve these kinds of problems.,00:03:06.020,00:03:07.220
"&gt;&gt; And I dare say with CSS, and HTML more
generally, you can solve problems in",00:03:07.220,00:03:11.520
"many more ways, all of which might very
well be correct, than you could",00:03:11.520,00:03:15.910
"in something like C, even
now PHP, or JavaScript.",00:03:15.910,00:03:18.900
"There are just many different
ways to lay things out.",00:03:18.900,00:03:21.080
"&gt;&gt; But this started to get
messy, we said.",00:03:21.080,00:03:22.570
"Just kind of commingling your HTML and
your CSS with the style attribute was",00:03:22.570,00:03:26.480
a little sloppy.,00:03:26.480,00:03:27.590
"And so we instead said, sort of
abstractly speaking, that you should",00:03:27.590,00:03:31.460
"at least start to factor
out your CSS probably.",00:03:31.460,00:03:34.050
"Not your style attributes, but at least
use the style tag inside what",00:03:34.050,00:03:37.430
part of the web page?,00:03:37.430,00:03:38.840
&gt;&gt; AUDIENCE: Head.,00:03:38.840,00:03:39.560
&gt;&gt; DAVID MALAN: In the head.,00:03:39.560,00:03:40.120
"Up until now, we only had the title up
there, but you can also add a style",00:03:40.120,00:03:43.270
"tag, and you can put your CSS roughly
speaking toward the top of the page.",00:03:43.270,00:03:47.230
"But then we took things one step further
and we factored that out more",00:03:47.230,00:03:52.550
into a separate file.,00:03:52.550,00:03:54.130
"&gt;&gt; And so these two files were
somehow now linked.",00:03:54.130,00:03:57.240
"And indeed it was the 
tag that did that.",00:03:57.240,00:03:59.550
"And what was one of the overarching
motivations for factoring out our CSS",00:03:59.550,00:04:02.920
all the more?,00:04:02.920,00:04:04.057
&gt;&gt; AUDIENCE: Reusability.,00:04:04.057,00:04:05.280
&gt;&gt; DAVID MALAN: Reusability.,00:04:05.280,00:04:05.785
Right?,00:04:05.785,00:04:06.150
"You may have seen in p-set seven already
that a lot of the pages, the",00:04:06.150,00:04:09.470
"buying page, the selling page, the
portfolio page, are probably",00:04:09.470,00:04:12.260
structured somewhat similarly.,00:04:12.260,00:04:13.550
"There's a CS50 finance logo at the top
unless you've decided to change it.",00:04:13.550,00:04:17.579
"There's a footer at the
bottom of pages.",00:04:17.579,00:04:19.839
"And CSS allows you then to factor it out
it into a separate file so that if",00:04:19.839,00:04:24.315
"you want to change something globally
across your whole site, you can really",00:04:24.315,00:04:27.780
just change it in one place.,00:04:27.780,00:04:29.390
"&gt;&gt; But there is a price you pay potentially
by having factored out the",00:04:29.390,00:04:32.750
"CSS from my HTML file into a separate
file referencing it with the ",00:04:32.750,00:04:38.380
"tag, which we saw on Monday.",00:04:38.380,00:04:40.650
What might the downside be of this?,00:04:40.650,00:04:43.850
"Thinking back a week ago to when we're
talking about HTTP and TCP/IP and how",00:04:43.850,00:04:48.830
the internet works.,00:04:48.830,00:04:52.070
Something over here?,00:04:52.070,00:04:53.530
&gt;&gt; AUDIENCE: It takes more time.,00:04:53.530,00:04:54.730
&gt;&gt; DAVID MALAN: It takes more time.,00:04:54.730,00:04:55.470
Why?,00:04:55.470,00:04:56.750
&gt;&gt; AUDIENCE: [INAUDIBLE].,00:04:56.750,00:04:59.450
&gt;&gt; DAVID MALAN: Yeah.,00:04:59.450,00:04:59.750
So it arguably takes a bit more time.,00:04:59.750,00:05:01.240
"Because one, the CSS is obviously
not in the same file.",00:05:01.240,00:05:04.290
"So now you have to make not
one, but two requests.",00:05:04.290,00:05:06.920
"And each of those requests as we saw in
Chrome in the so-called Inspector,",00:05:06.920,00:05:11.230
"and we looked at the network tab, each
of those files requires one HTTP",00:05:11.230,00:05:15.740
"request, which we saw takes
some amount of time.",00:05:15.740,00:05:18.360
"Now, maybe it's not a lot.",00:05:18.360,00:05:19.290
Maybe it's only 20 milliseconds.,00:05:19.290,00:05:20.670
Maybe it's 200 milliseconds.,00:05:20.670,00:05:22.260
"&gt;&gt; But think about a page like Facebook,
or CNN, or Google, which are much",00:05:22.260,00:05:25.530
"larger than the examples we've
looked at thus far.",00:05:25.530,00:05:28.060
"Those pages might have dozens of files,
each of which might require a",00:05:28.060,00:05:32.070
download of a file.,00:05:32.070,00:05:33.550
"So things can potentially
start to slow down.",00:05:33.550,00:05:35.800
"&gt;&gt; And especially these days when we all
have mobile phones in our pockets and",00:05:35.800,00:05:39.280
"slower internet connections, having to
wait a few more milliseconds, a few",00:05:39.280,00:05:43.010
"more milliseconds for additional
files can actually be slow.",00:05:43.010,00:05:46.110
"Latency is the word that describes the
kind of waiting that you have that you",00:05:46.110,00:05:50.430
"experience when waiting for
some piece of information.",00:05:50.430,00:05:53.110
&gt;&gt; But there is an upside.,00:05:53.110,00:05:54.430
So it's not all sort of a--,00:05:54.430,00:05:56.600
it actually is a bit of a seesaw here.,00:05:56.600,00:05:58.170
"Downside now, but what browsers can do
if they're smart in order to avoid",00:05:58.170,00:06:02.970
"having to request the same styles.css
file again can be to do what?",00:06:02.970,00:06:08.870
&gt;&gt; Cache it.,00:06:08.870,00:06:09.390
So caching--,00:06:09.390,00:06:10.370
C-A-C-H-E--,00:06:10.370,00:06:11.690
"generally means here just to save the
file you requested the first time, and",00:06:11.690,00:06:15.810
then check your cache for it.,00:06:15.810,00:06:17.440
"Check you're sort of storage container,
and if you already have a",00:06:17.440,00:06:20.400
"copy of styles.css, even if some other
page in the p-set, or any website,",00:06:20.400,00:06:24.520
"requests it again, just to give the
user that same cached copy.",00:06:24.520,00:06:28.560
Don't bother requesting it.,00:06:28.560,00:06:30.140
"&gt;&gt; Downside there, though, as some of you
have tripped over in the p-set.",00:06:30.140,00:06:32.560
"If you make a change on the server and
you go back to the browser and you",00:06:32.560,00:06:35.870
"reload, sometimes the browser does
you a favor and doesn't bother",00:06:35.870,00:06:39.250
"re-downloading your styles.css file
because, come on, what are the odds",00:06:39.250,00:06:43.660
"that these styles that Facebook uses
are going to change hour to hour or",00:06:43.660,00:06:47.620
day to day?,00:06:47.620,00:06:48.140
It's pretty low.,00:06:48.140,00:06:48.800
"They might change over time, but not
by the minute or by the hour.",00:06:48.800,00:06:52.260
"&gt;&gt; So a trick, just FYI when doing web
development, is often hold down the",00:06:52.260,00:06:55.810
"shift key for instance and then click
reload in your browser, and that will",00:06:55.810,00:06:59.500
"typically tell the browser reload
everything, even if you already have",00:06:59.500,00:07:03.280
it in the cache.,00:07:03.280,00:07:04.180
"So again, upsides and downsides,
but all of them",00:07:04.180,00:07:06.630
ultimately design decisions.,00:07:06.630,00:07:08.260
"&gt;&gt; So now, we didn't just
end the story here.",00:07:08.260,00:07:11.520
"If I now go back and back and back and
back, we started to introduce not just",00:07:11.520,00:07:15.790
"HTML, but PHP.",00:07:15.790,00:07:18.060
"So in layman's terms, what
does PHP let us do?",00:07:18.060,00:07:20.786
&gt;&gt; AUDIENCE: [INAUDIBLE].,00:07:20.786,00:07:22.770
&gt;&gt; DAVID MALAN: What's that?,00:07:22.770,00:07:24.258
"&gt;&gt; AUDIENCE: Introduce logic
into the code.",00:07:24.258,00:07:25.250
"&gt;&gt; DAVID MALAN: Yeah, introduce
logic into your code.",00:07:25.250,00:07:26.620
"So it's a true programming language
with loops, and variables, and",00:07:26.620,00:07:29.570
"functions, and conditions, and all of
the things we've been using way back",00:07:29.570,00:07:32.620
when since scratch.,00:07:32.620,00:07:33.780
"And PHP, we've seen, can be used
either at the command line-- it",00:07:33.780,00:07:36.780
"doesn't have to have anything to do
with the web, even though that's",00:07:36.780,00:07:39.190
"really its origins and what it tends
to be good at and conducive to--",00:07:39.190,00:07:43.150
"but you can use PHP merely by nature
of the fact that it has a print()",00:07:43.150,00:07:47.130
"function, and a printf() function,
or an echo() function.",00:07:47.130,00:07:49.660
"There's bunches of ways you
can print text with PHP.",00:07:49.660,00:07:52.440
"&gt;&gt; Therefore, you can use this programming
language to output exactly",00:07:52.440,00:07:56.540
what we were talking about before.,00:07:56.540,00:07:58.460
"You can dynamically generate
your HTML.",00:07:58.460,00:08:01.360
Maybe not all of it.,00:08:01.360,00:08:02.300
"Maybe you hard code things, like the
header, and the footer, and the logo,",00:08:02.300,00:08:06.460
"and your style sheets,
and all of that.",00:08:06.460,00:08:07.950
"But for something like p-set seven,
where you're manipulating stocks and",00:08:07.950,00:08:11.190
"showing the user's portfolio, which is
going to dynamically change, you could",00:08:11.190,00:08:14.690
"surely use PHP and the logic it gives
you as a programming language to",00:08:14.690,00:08:18.960
"output dynamically subsets
of the page.",00:08:18.960,00:08:22.320
"&gt;&gt; So when you talk about dynamic websites,
or web programming, that's",00:08:22.320,00:08:25.900
what you're really talking about.,00:08:25.900,00:08:27.200
"Using a language like PHP, or things
called Python, or Ruby, or Java, or",00:08:27.200,00:08:31.450
"yet other languages, to query a database
often, or another server, and",00:08:31.450,00:08:35.900
then dynamically spit out HTML.,00:08:35.900,00:08:38.580
"&gt;&gt; Now the end result, as an aside, is
that the HTML of most websites,",00:08:38.580,00:08:42.470
"including your p-set seven, is probably
going to be a huge mess if",00:08:42.470,00:08:45.970
"you look at the source
code in a browser.",00:08:45.970,00:08:48.060
That's not a big deal.,00:08:48.060,00:08:49.010
"At this point, when we care about
style, we care about the",00:08:49.010,00:08:51.550
stuff that you write.,00:08:51.550,00:08:52.740
"We won't care about the stuff
that what your code outputs.",00:08:52.740,00:08:56.240
"So don't worry about indentation
here if it's PHP that's",00:08:56.240,00:08:59.520
actually outputting stuff.,00:08:59.520,00:09:01.190
"After all, the browser won't care,
and a human won't be looking",00:09:01.190,00:09:04.430
at the source anyway.,00:09:04.430,00:09:05.400
"We the staff, for instance, would
be looking at your PHP.",00:09:05.400,00:09:09.000
"&gt;&gt; So let me give a quick example now
of why else this might be useful.",00:09:09.000,00:09:13.440
"So frankly, I can't remember the last
time I used C to solve a problem in",00:09:13.440,00:09:18.620
the real world.,00:09:18.620,00:09:19.620
"It was probably in graduate school when
I needed to use a language that",00:09:19.620,00:09:22.330
"was fairly low level and gave me the
opportunity to do something very high",00:09:22.330,00:09:26.710
"performing to really save as many CPU
cycles as I could, in large part",00:09:26.710,00:09:30.720
"because I was using huge data sets,
and every CPU cycle counted.",00:09:30.720,00:09:33.990
"And frankly, even in things like phones
these days and other devices",00:09:33.990,00:09:37.750
"where you don't quite have as much
memory and you don't quite have as",00:09:37.750,00:09:39.910
"much CPU, using faster languages
is still appealing.",00:09:39.910,00:09:44.160
"&gt;&gt; But in the real world, when you just
want to throw some program together to",00:09:44.160,00:09:47.290
"analyze some data, or you've collected
a whole bunch of registrations for",00:09:47.290,00:09:50.340
"some student group and you want to very
quickly automate sending emails",00:09:50.340,00:09:53.330
"one by one to every one of those
registrants, you're going to reach for",00:09:53.330,00:09:56.240
"a higher level language
than C so to speak.",00:09:56.240,00:09:59.240
"Something like PHP or Python, or Ruby,
or a half a dozen others that exist",00:09:59.240,00:10:04.060
these days.,00:10:04.060,00:10:04.550
"But those three are probably
the most trendy right now.",00:10:04.550,00:10:07.200
"&gt;&gt; And what this means is that you can open
up a text editor like gedit or",00:10:07.200,00:10:10.840
"most anything else and then just start
writing code without having to worry",00:10:10.840,00:10:14.030
"about compiling, without having to
really worry about memory management,",00:10:14.030,00:10:17.800
"keeping in mind though that a little
sloppiness will eventually come back",00:10:17.800,00:10:20.820
"to bite you if the data set gets
larger or the problem gets big.",00:10:20.820,00:10:24.790
"But what this means for
us is the following.",00:10:24.790,00:10:27.230
"&gt;&gt; Let me go ahead and run speller
from problem set six.",00:10:27.230,00:10:29.860
"So this is my trie-based implementation
that I used on the big",00:10:29.860,00:10:33.480
board where I performed not so well.,00:10:33.480,00:10:35.500
"We'll come back in a week's time and
revisit those who did end up atop the",00:10:35.500,00:10:38.720
big board at our last lecture.,00:10:38.720,00:10:40.430
"But for now, let me go ahead and just
run my solution in text, and we'll do",00:10:40.430,00:10:44.520
"the King James Bible, and here we go.",00:10:44.520,00:10:48.460
"&gt;&gt; So those are all of the supposedly
misspelled words out of",00:10:48.460,00:10:51.080
the King James Bible.,00:10:51.080,00:10:52.240
"And my implementation took
half a second in total.",00:10:52.240,00:10:55.560
"So not too bad on this
particular computer.",00:10:55.560,00:10:58.270
"But think of how much
code I had to write.",00:10:58.270,00:11:01.540
Think how much code you had to write.,00:11:01.540,00:11:02.880
"Think how many hours you spent in the
D-hall or your dorm or wherever",00:11:02.880,00:11:06.170
actually coding up that solution.,00:11:06.170,00:11:07.890
"&gt;&gt; Well, if I actually have a higher level
language like PHP, take note of",00:11:07.890,00:11:11.850
what I can do here.,00:11:11.850,00:11:13.350
"First, suppose that this is instead
your distribution code.",00:11:13.350,00:11:16.410
This is a file called speller.,00:11:16.410,00:11:17.790
"It's available as part of today's
distribution code.",00:11:17.790,00:11:20.220
"And I'm going to wave my hand at most
of the details, but this is actually",00:11:20.220,00:11:22.670
"an interesting example of how
you might port a language",00:11:22.670,00:11:25.500
like C over to PHP.,00:11:25.500,00:11:28.870
"I literally opened two text windows,
one with my C version of speller.c,",00:11:28.870,00:11:33.420
"and I just started translating it in my
head to PHP and typing it out using",00:11:33.420,00:11:36.960
the closest equivalent functions.,00:11:36.960,00:11:38.840
&gt;&gt; So some of these things are different.,00:11:38.840,00:11:40.100
"We saw last time that PHP doesn't use
include in quite the same way.",00:11:40.100,00:11:43.730
"It uses require typically, though
include does exist.",00:11:43.730,00:11:47.050
"Define is a little different from
#define in C, but that's",00:11:47.050,00:11:50.330
how we make a constant.,00:11:50.330,00:11:51.890
"$argc it turns out exists in PHP,
so we've seen that before.",00:11:51.890,00:11:55.860
"These are just variables, all of
which start with dollar signs.",00:11:55.860,00:11:58.650
"Recall these are just a bunch
of floating points.",00:11:58.650,00:12:00.590
"&gt;&gt; So long story short, you're welcome to
flip through this if curious, this is",00:12:00.590,00:12:03.970
"almost a line-for-line conversion of the
C version of speller.c into PHP.",00:12:03.970,00:12:10.010
"And you could do this again for
half a dozen other languages.",00:12:10.010,00:12:12.630
&gt;&gt; But what's interesting is this.,00:12:12.630,00:12:14.910
"Or what's frankly disheartening
is this.",00:12:14.910,00:12:16.910
"Let me go ahead and type about
dictionary.php, and claim that I'm",00:12:16.910,00:12:20.790
"going to go ahead and re-implement
problem set six here.",00:12:20.790,00:12:23.670
"&gt;&gt; So let's propose first that in this
file, which will be implemented in",00:12:23.670,00:12:27.530
"PHP, so let me open my tags like that.",00:12:27.530,00:12:30.550
"Let me give myself a global
variable, $size gets zero.",00:12:30.550,00:12:34.780
"And I'm going to give
myself a hash table.",00:12:34.780,00:12:36.710
I'll use a hash table for this thing.,00:12:36.710,00:12:38.110
How do I declare a hash table in PHP?,00:12:38.110,00:12:42.070
Done.,00:12:42.070,00:12:42.990
OK.,00:12:42.990,00:12:43.980
"&gt;&gt; So open bracket close bracket represents
what in PHP, as we've seen?",00:12:43.980,00:12:48.870
"An array, but an array that could
be an associative array.",00:12:48.870,00:12:51.850
"An associative array is
a data structure that",00:12:51.850,00:12:54.320
associates keys with values.,00:12:54.320,00:12:55.860
"&gt;&gt; Now in the simplest numerically indexed
array, those keys are what?",00:12:55.860,00:12:59.430
"Zero, one, two, three, right?",00:13:02.250,00:13:03.960
"Old school stuff back from C. But it can
also be strings like foo, and bar,",00:13:03.960,00:13:08.780
"or maxwell, or any such string.",00:13:08.780,00:13:12.210
"So I can leverage that
in just a moment.",00:13:12.210,00:13:14.240
"&gt;&gt; Let me go ahead and declare
a function like--",00:13:14.240,00:13:17.550
let's do load() first.,00:13:17.550,00:13:19.020
So function load().,00:13:19.020,00:13:20.690
"And PHP is a little different in that
you literally type function, but you",00:13:20.690,00:13:23.440
don't type a return type.,00:13:23.440,00:13:24.930
"I'm going to go ahead and say that the
load() function should take in",00:13:24.930,00:13:28.760
"argument $dictionary, just
like C version did.",00:13:28.760,00:13:31.000
I'm doing that from memory.,00:13:31.000,00:13:32.510
"&gt;&gt; And I propose that I'm
going to do this.",00:13:32.510,00:13:34.910
I'm simply going to do foreach.,00:13:34.910,00:13:37.080
"I'm going to call a function called
file(), passing in the name of that",00:13:37.080,00:13:40.710
"file, which is the variable
$dictionary as $word.",00:13:40.710,00:13:44.990
"And then inside of my for loop here, I'm
going to go ahead and store in my",00:13:44.990,00:13:49.410
$table that $word gets true.,00:13:49.410,00:13:57.440
Done.,00:13:57.440,00:13:57.918
"Oh, wait.",00:13:57.918,00:14:01.264
Done.,00:14:01.264,00:14:02.422
OK.,00:14:02.422,00:14:02.760
"&gt;&gt; That is the load() function
say in PHP.",00:14:02.760,00:14:04.970
"Now, why does that work?",00:14:04.970,00:14:05.865
And I'm kind of cheating here.,00:14:05.865,00:14:07.010
"&gt;&gt; So, one, foreach we saw
briefly last time.",00:14:07.010,00:14:09.980
"It just means that you can iterate over
an array without bothering with i",00:14:09.980,00:14:13.680
"and n and plus plus, and all of that.",00:14:13.680,00:14:16.150
"Dictionary is of course the file name,
something like large or small, the two",00:14:16.150,00:14:21.350
dictionaries we used last time.,00:14:21.350,00:14:22.830
"File is a function that opens up text
file, reads it in line by line, and",00:14:22.830,00:14:26.715
"hands you back a huge array,
each of whose elements is a",00:14:26.715,00:14:29.840
line from that file.,00:14:29.840,00:14:31.340
"So that's the combination of fopen, and
fread, and while loop, and fclose,",00:14:31.340,00:14:36.040
and all of that.,00:14:36.040,00:14:37.080
"Finally, as word just means that's the
variable I'm going to have access to",00:14:37.080,00:14:40.150
on every iteration in this loop.,00:14:40.150,00:14:41.890
"&gt;&gt; So in short, this one liner here means
open up the file whose name is in",00:14:41.890,00:14:46.910
"dictionary, the variable, iterate over
it line by line, and each time you get",00:14:46.910,00:14:50.750
"a line, store in a variable called word,
and then do something with word.",00:14:50.750,00:14:54.290
What do I want to do?,00:14:54.290,00:14:55.280
I want to put word into my hash table.,00:14:55.280,00:14:58.110
"&gt;&gt; Well, I can put something in my
hash table just like in C",00:14:58.110,00:15:00.860
using square brackets.,00:15:00.860,00:15:02.140
This is the name for my hash table.,00:15:02.140,00:15:03.660
"I'm going to index into that hash
table at this location.",00:15:03.660,00:15:07.180
"So not bracket zero, not bracket one.",00:15:07.180,00:15:08.920
"Bracket quote unquote something,
whatever that word is.",00:15:08.920,00:15:11.990
"And just like you might have in your
hash table work trie, you just store",00:15:11.990,00:15:15.200
"effectively a Boolean, implicitly
or explicitly.",00:15:15.200,00:15:17.650
Done.,00:15:17.650,00:15:18.260
I'm storing the value true.,00:15:18.260,00:15:20.000
"&gt;&gt; Now there's a couple of things
I'm cutting corners on here.",00:15:20.000,00:15:23.150
"Technically, there's going to be an
annoying new line, /n, at the end of",00:15:23.150,00:15:27.720
each of these words.,00:15:27.720,00:15:28.820
"So I should probably call a PHP function
called chop(), which will",00:15:28.820,00:15:31.770
quite literally chop that off.,00:15:31.770,00:15:33.460
"And I actually need to
do one other thing.",00:15:33.460,00:15:35.020
"I should probably increment size on each
iteration, so I'm keeping track",00:15:35.020,00:15:38.380
globally of what it is.,00:15:38.380,00:15:39.560
"And frankly, and this is one of the
stupider aspects of PHP, if you're",00:15:39.560,00:15:43.180
"using a global variable, you need
to explicitly say that you are.",00:15:43.180,00:15:46.950
"So I'm going to actually type in global
$size, global $table, and now",00:15:46.950,00:15:51.670
my function is complete.,00:15:51.670,00:15:52.690
"&gt;&gt; So not quite as simple as before, but
probably took less time than the C",00:15:52.690,00:15:57.475
"version, maybe?",00:15:57.475,00:15:58.220
OK.,00:15:58.220,00:15:58.730
&gt;&gt; So now let's do the check() function.,00:15:58.730,00:16:00.390
"Let's see if this at least took the
hours on end that it took us in C. So",00:16:00.390,00:16:04.300
"let me go ahead and declare
check as a function.",00:16:04.300,00:16:06.500
"Takes in argument word, which is
going to come from speller.",00:16:06.500,00:16:09.070
"And I'm just going to check if the
following variable isset, table",00:16:09.070,00:16:13.410
bracket strtolower of word--,00:16:13.410,00:16:18.400
let's balance all of my parentheses--,00:16:18.400,00:16:20.590
then return true.,00:16:20.590,00:16:24.275
Else--,00:16:27.020,00:16:28.460
"that was really the hard
part of this program.",00:16:28.460,00:16:30.330
"Else, return false.",00:16:30.330,00:16:31.940
Done.,00:16:31.940,00:16:32.630
That's check().,00:16:32.630,00:16:33.460
"&gt;&gt; Now, why does this work?",00:16:33.460,00:16:34.520
"Well, one I passed in a word,
which is a string.",00:16:34.520,00:16:37.040
"Two, I'm checking inside of the hash
table, who's called $table.",00:16:37.040,00:16:41.400
"I'm forcing it to lowercase by calling
a function quite similar tolower() in",00:16:41.400,00:16:45.470
"C, but this does the whole word,
not a single character.",00:16:45.470,00:16:48.580
"And if that is set, in other words there
is a value set, in other words,",00:16:48.580,00:16:52.680
"if it's true, then yes,
this is a word.",00:16:52.680,00:16:54.880
Because I put it there with load().,00:16:54.880,00:16:56.530
"And if not, I'm going to return false.",00:16:56.530,00:16:59.100
&gt;&gt; Now the others are easy.,00:16:59.100,00:17:00.090
"Function size(), how do I do this?",00:17:00.090,00:17:03.570
I essentially do return $size.,00:17:03.570,00:17:05.230
"But I technically need to
do this annoying thing.",00:17:05.230,00:17:07.770
"And actually up hear, I was cutting
one corner too many.",00:17:07.770,00:17:10.640
I really need to do global $table.,00:17:10.640,00:17:12.920
"&gt;&gt; But that being said, unload).",00:17:12.920,00:17:16.260
Unload() is amazing.,00:17:16.260,00:17:17.380
Function unload().,00:17:17.380,00:17:20.500
How do I want to implement unload()?,00:17:20.500,00:17:23.990
Done.,00:17:23.990,00:17:25.079
OK.,00:17:25.079,00:17:25.450
"&gt;&gt; So unload(), memory management is
completely taken care of for you in",00:17:25.450,00:17:28.900
"something like PHP and a lot
of higher-level languages.",00:17:28.900,00:17:31.800
So this is amazing.,00:17:31.800,00:17:32.600
"Like why the hell did we spent the past
eight plus weeks on C writing",00:17:32.600,00:17:36.080
"apparently really slow, really time
consuming problems with tens of hours",00:17:36.080,00:17:41.030
of work under our belts?,00:17:41.030,00:17:42.530
"&gt;&gt; Well, for one thing, this may work
fine for small programs.",00:17:42.530,00:17:46.110
"It certainly sped up my
development time.",00:17:46.110,00:17:47.840
"But let's see what happens
in the real world.",00:17:47.840,00:17:49.790
"&gt;&gt; Let me go into this directory
in a terminal window.",00:17:49.790,00:17:52.370
There's speller.,00:17:52.370,00:17:53.370
"And notice as an aside, and you might
have encountered this in problem set",00:17:53.370,00:17:56.570
six or problem set seven.,00:17:56.570,00:17:58.190
"You don't strictly have to
end PHP files with .php.",00:17:58.190,00:18:01.610
"If you put a line like that first one at
the very top, that's a special line",00:18:01.610,00:18:05.250
"of syntax that essentially means find
the program called PHP and use it to",00:18:05.250,00:18:10.980
interpret this file.,00:18:10.980,00:18:12.270
"So now no one really knows that
I'm running a PHP program.",00:18:12.270,00:18:15.410
"I can run it just as though it
were something compiled in C.",00:18:15.410,00:18:19.860
&gt;&gt; But here's the thing.,00:18:19.860,00:18:20.650
"Actually, let's do this again.",00:18:20.650,00:18:21.600
Dropbox/pset6/.,00:18:21.600,00:18:23.530
There's speller.,00:18:23.530,00:18:25.390
"OK, 0.44 seconds.",00:18:25.390,00:18:26.720
It got faster this time.,00:18:26.720,00:18:28.080
&gt;&gt; Now let's go into the PHP version.,00:18:28.080,00:18:29.745
Nice touch.,00:18:43.070,00:18:44.320
"But just think how much time
I saved at office hours.",00:18:50.830,00:18:53.285
OK.,00:18:56.990,00:18:57.790
"&gt;&gt; So 3.59 seconds, which actually
doesn't sound accurate either.",00:18:57.790,00:19:01.020
"But that's because long story short,
when you're printing out a huge amount",00:19:01.020,00:19:03.710
"of stuff to the screen, that
itself slows things down.",00:19:03.710,00:19:06.840
"What it really took the CPU in the
appliance was 3.59 seconds, in",00:19:06.840,00:19:11.260
"contrast to C, which took 0.44
seconds most recently.",00:19:11.260,00:19:15.260
"That's truly an order of
magnitude different.",00:19:15.260,00:19:17.620
&gt;&gt; So where is that price coming from?,00:19:17.620,00:19:20.280
Why is it so much slower?,00:19:20.280,00:19:21.790
Why does PHP perform so poorly?,00:19:21.790,00:19:24.220
Danielle?,00:19:24.220,00:19:25.242
"&gt;&gt; AUDIENCE: You didn't really
use a hash table.",00:19:25.242,00:19:26.550
"&gt;&gt; DAVID MALAN: I didn't really
use a hash table.",00:19:26.550,00:19:27.710
So I kind of did.,00:19:27.710,00:19:28.760
So it's an associative array.,00:19:28.760,00:19:29.870
"Most likely if the people at PHP are
really smart, they used underneath the",00:19:29.870,00:19:33.650
"hood an actual hash table implemented
in something like C or C++.",00:19:33.650,00:19:39.520
But.,00:19:39.520,00:19:41.290
Yeah.,00:19:41.290,00:19:42.760
&gt;&gt; AUDIENCE: [INAUDIBLE].,00:19:42.760,00:19:44.010
&gt;&gt; DAVID MALAN: Yeah.,00:19:46.690,00:19:47.080
"So each of the functions I wrote now--
actually, can you say that once more a",00:19:47.080,00:19:50.780
little louder?,00:19:50.780,00:19:51.480
"&gt;&gt; AUDIENCE: Each of the functions that
you included has a lot more full",00:19:51.480,00:19:54.509
capacity than--,00:19:54.509,00:19:56.610
&gt;&gt; DAVID MALAN: So that's very true.,00:19:56.610,00:19:57.550
"There's a lot more overhead that we're
not really seeing by focusing only on",00:19:57.550,00:20:01.490
"dictionary.php, which I just wrote.",00:20:01.490,00:20:03.730
"By contrast, there's a whole interpreter
going in the background.",00:20:03.730,00:20:08.020
"Indeed, when I ran this program, it
wasn't running compiled zeros and ones",00:20:08.020,00:20:12.040
designed for my Intel CPU.,00:20:12.040,00:20:14.290
"Rather, it was running line by line
PHP code that looks exactly",00:20:14.290,00:20:19.270
like we typed it.,00:20:19.270,00:20:20.350
"And so whenever you use an
interpreted language, you",00:20:20.350,00:20:22.475
actually do pay this price.,00:20:22.475,00:20:23.850
"It's going to take some time to read
your file top to bottom, left to",00:20:23.850,00:20:27.010
"right, and then execute each
line again and again.",00:20:27.010,00:20:30.740
"&gt;&gt; Now in reality, especially on the web,
you can actually expedite this process",00:20:30.740,00:20:34.250
"by caching the results of the
PHP code being interpreted.",00:20:34.250,00:20:38.660
"And that makes sense on the web, because
if you have not one user like",00:20:38.660,00:20:41.640
"me here, but 1,000 or 10,000 users, then
maybe the first time the file is",00:20:41.640,00:20:46.300
"accessed it's slow, but thereafter
it's much faster.",00:20:46.300,00:20:49.050
"&gt;&gt; But this too, again, is a trade off.",00:20:49.050,00:20:51.000
"And for something like a research data
set, or even something large like",00:20:51.000,00:20:53.870
"this, your users will eventually
start to feel that slowdown.",00:20:53.870,00:20:58.330
"&gt;&gt; So in short, interpreted languages are
very much in vogue, very popular, and",00:20:58.330,00:21:02.670
"frankly are probably the languages you
should reach for when solving problems",00:21:02.670,00:21:06.710
subsequent to CS50.,00:21:06.710,00:21:08.200
"But realize how much you're really
taking for granted underneath the hood",00:21:08.200,00:21:12.720
"really those past several weeks in hash
tables, and trees, and tries,",00:21:12.720,00:21:15.910
"which are used ultimately to actually
implement things like open bracket,",00:21:15.910,00:21:20.770
"square bracket, which we can now
gratefully take for granted.",00:21:20.770,00:21:24.200
"&gt;&gt; So let's take a look now
in this web context.",00:21:24.200,00:21:26.360
"And I mentioned last time that there's
a bunch of superglobals in PHP that",00:21:26.360,00:21:29.890
"aren't really relevant
at the command line.",00:21:29.890,00:21:32.490
"They're more relevant in the context
of using PHP in a web context.",00:21:32.490,00:21:36.210
"So running PHP on a web server in order
to generate stuff like HTML.",00:21:36.210,00:21:41.220
"&gt;&gt; And we glanced at $_GET and $_POST, and
that's where automatically users'",00:21:41.220,00:21:44.540
"input ends up simply if you submit a
form to a file ending in .php on a web",00:21:44.540,00:21:49.100
server like the appliance.,00:21:49.100,00:21:50.460
"But let's look briefly at
$_COOKIE and $_SESSION.",00:21:50.460,00:21:53.310
"&gt;&gt; In layman's terms, what is a cookie as
you understand it in the context of",00:21:53.310,00:21:56.670
using the web?,00:21:56.670,00:21:58.220
&gt;&gt; AUDIENCE: File on the computer.,00:21:58.220,00:21:59.450
&gt;&gt; DAVID MALAN: Yeah.,00:21:59.450,00:21:59.920
"It's a file on the user's computer
planted by whatever website",00:21:59.920,00:22:03.500
you happen to visit.,00:22:03.500,00:22:04.410
"So when you go to Facebook, when you go
to bankofamerica.com, when you go",00:22:04.410,00:22:07.334
"to google.com, when you go to almost any
website in the world these days,",00:22:07.334,00:22:10.330
"including cs50.net, a cookie is planted
on your computer, which is",00:22:10.330,00:22:14.850
"either a value stored in RAM in your
computer in your browser's memory, or",00:22:14.850,00:22:19.800
"sometimes indeed a file stored
on your hard drive.",00:22:19.800,00:22:22.800
"&gt;&gt; And what's typically stored in that file
is not your user name, not your",00:22:22.800,00:22:26.960
"password, typically not something
sensitive unless the website is not so",00:22:26.960,00:22:31.060
"good with their security, but rather
it is a big unique identifier among",00:22:31.060,00:22:35.040
other things.,00:22:35.040,00:22:35.680
"It's a big random number planted on your
computer but you can think of as",00:22:35.680,00:22:38.920
"sort of a virtual hand stamp like from
a club or some amusement park that",00:22:38.920,00:22:42.740
"allows the staff, the owners of that
service, to remember who you are.",00:22:42.740,00:22:47.160
"So if the big random number is like
12345678, although that's obviously",00:22:47.160,00:22:51.030
"not too random, think of that as the
hand stamp that when you visit",00:22:51.030,00:22:54.180
"facebook.com for the first time, they
stamp that number on your hand.",00:22:54.180,00:22:57.930
"And then because you speak HTTP, you
being a browser, and because Facebook",00:22:57.930,00:23:01.510
"obviously speaks the same as a web
server, the protocol HTTP says that",00:23:01.510,00:23:06.440
"anytime you subsequently visit
facebook.com, whether it's a second",00:23:06.440,00:23:09.930
"later, an hour later, even the next day,
so long as you haven't explicitly",00:23:09.930,00:23:13.560
"logged out, which effectively
is like washing your hands.",00:23:13.560,00:23:17.050
"HTTP says you should present your
hand stamp every time you",00:23:17.050,00:23:20.280
return to that website.,00:23:20.280,00:23:22.020
"&gt;&gt; What Facebook then does is they
look at that hand stamp and",00:23:22.020,00:23:24.390
"they say, oh, 123456789.",00:23:24.390,00:23:26.850
"I don't know at first glance that this
is David Malan in Cambridge,",00:23:26.850,00:23:30.260
"Massachusetts, but they can check their
database and say, oh, the person",00:23:30.260,00:23:34.690
"on whose computer we planted 123456789
is David Malan from Cambridge,",00:23:34.690,00:23:39.930
Massachusetts.,00:23:39.930,00:23:40.440
"Let's show that user then his profile
page or his News Feed.",00:23:40.440,00:23:46.000
"&gt;&gt; But there's a problem here if this
is how the web indeed works.",00:23:46.000,00:23:49.660
Let's take a look at a quick example.,00:23:49.660,00:23:51.390
Let's actually go to say facebook.com.,00:23:51.390,00:23:55.190
"But before we could go there, let
me go ahead and open up Chrome's",00:23:55.190,00:23:58.130
Inspector down here.,00:23:58.130,00:23:59.790
Let me look at the network tab.,00:23:59.790,00:24:01.140
"And now let's go ahead and type
in https://facebook.com.",00:24:01.140,00:24:06.020
"And I'm doing that so that we don't see
all of those redirects and waste",00:24:06.020,00:24:09.410
time looking through those.,00:24:09.410,00:24:10.660
Let me hit enter.,00:24:10.660,00:24:12.690
&gt;&gt; All right.,00:24:12.690,00:24:13.130
We see a whole bunch of requests.,00:24:13.130,00:24:14.580
There comes Facebook.,00:24:14.580,00:24:15.640
There's a whole bunch of files.,00:24:15.640,00:24:16.930
"And here, per my mention of
latency last time, that's",00:24:16.930,00:24:19.290
a lot of HTTP requests.,00:24:19.290,00:24:21.240
"But the first one is probably
the most interesting.",00:24:21.240,00:24:23.700
"&gt;&gt; So let's scroll down here, and
I'll zoom in in a second.",00:24:23.700,00:24:26.420
"This is going to be kind of
a mess, but let's see.",00:24:26.420,00:24:29.090
"Facebook is sending us a
whole bunch of stuff.",00:24:29.090,00:24:31.660
"&gt;&gt; But whoa, interesting.",00:24:31.660,00:24:33.490
"They're planting not one, but four
hand stamps onto my hand here.",00:24:33.490,00:24:37.880
"Set-cookie, Set-cookie, set-cookie,
set-cookie.",00:24:37.880,00:24:40.400
And there are a few features here.,00:24:40.400,00:24:44.030
"All of them mention some
kind of expiration.",00:24:44.030,00:24:46.170
"And it looks like Facebook is hoping
to remember me until 2015.",00:24:46.170,00:24:50.090
"So that's presumably the time by which
I must log out or they'll just",00:24:50.090,00:24:53.670
"automatically assume I'm
not coming back.",00:24:53.670,00:24:55.710
"So that's actually a decent
amount of time.",00:24:55.710,00:24:57.840
"&gt;&gt; And there are some other
things going on here.",00:24:57.840,00:24:59.170
"This cookie appears to be forcibly
deleted by saying it expired in 1970",00:24:59.170,00:25:03.036
before cookies existed.,00:25:03.036,00:25:04.460
"So the browser is just going
to assume OK, that's like",00:25:04.460,00:25:06.510
washing the hands stamp.,00:25:06.510,00:25:07.910
"&gt;&gt; But now when my browser makes
a subsequent request--",00:25:07.910,00:25:11.240
"let me go ahead and do this
again and reload.",00:25:11.240,00:25:14.340
"Now let me scroll back to the
top request and go down",00:25:14.340,00:25:18.170
"here, request headers.",00:25:18.170,00:25:20.760
Notice this.,00:25:20.760,00:25:21.390
"So now I'm under not response headers,
but notice it says request headers.",00:25:21.390,00:25:25.280
"And notice that my browser as part of
its request after hitting reload has",00:25:25.280,00:25:29.220
"sent at least the following
information.",00:25:29.220,00:25:32.780
"Not set-cookie, but cookie.",00:25:32.780,00:25:34.670
"So this is the line, the HTTP header so
to speak, where my browser is sort",00:25:34.670,00:25:38.750
"of without my knowing it presenting
my hand for Facebook's inspection.",00:25:38.750,00:25:43.340
"&gt;&gt; So these cookies can be
used then for what?",00:25:43.340,00:25:46.020
"To remember who you are, or remember how
many times you've been there, or",00:25:46.020,00:25:49.420
really anything.,00:25:49.420,00:25:50.280
&gt;&gt; So here is counter.php.,00:25:50.280,00:25:52.742
And let me zoom in on the font.,00:25:52.742,00:25:53.780
"And each time I reload this page, notice
it's remembering how many times",00:25:53.780,00:25:58.380
I've been there.,00:25:58.380,00:25:59.250
"Well, that's not all that impressive.",00:25:59.250,00:26:00.570
"Let's just close that tab,
and now let's go back to",00:26:00.570,00:26:03.140
http://localhost/counter.php.,00:26:03.140,00:26:07.860
"&gt;&gt; Oh, that's interesting.",00:26:07.860,00:26:08.970
"It still remembered, even
though I closed the tab.",00:26:08.970,00:26:10.960
"And frankly, if I close the browser,
if implemented in the right way, I",00:26:10.960,00:26:14.010
"could still remember that this user is
who he or she was the first time, and",00:26:14.010,00:26:18.950
"only once I go into Chrome's menu, which
over here is here, and go to",00:26:18.950,00:26:22.840
"History, and click Clear Browsing Data,
as some of you may have in the",00:26:22.840,00:26:25.990
"past, only then will your cookies
actually be deleted during web",00:26:25.990,00:26:33.050
development.,00:26:33.050,00:26:33.970
"&gt;&gt; So, if we go--",00:26:33.970,00:26:35.340
let's close up gedit here.,00:26:35.340,00:26:37.080
And if we go now to this file.,00:26:37.080,00:26:38.910
"Let me go into our
vhosts/localhost/public, and let me do",00:26:38.910,00:26:44.210
counter.php.,00:26:44.210,00:26:46.340
"Notice that this is a pretty
simple program.",00:26:46.340,00:26:48.350
It's a pretty simple website.,00:26:48.350,00:26:50.250
"&gt;&gt; So the top of the file
is just comments.",00:26:50.250,00:26:51.770
"But here's a new line that you may
have seen already in p-set seven,",00:26:51.770,00:26:54.930
session_start().,00:26:54.930,00:26:56.000
"This is a line of PHP code that
essentially tells the web server, make",00:26:56.000,00:27:00.380
"sure to stamp hands and make
sure to check hand stamps.",00:27:00.380,00:27:03.400
"That's all that line does, and it
does all of that process for us.",00:27:03.400,00:27:06.810
"Then notice I've just got
two branches here.",00:27:06.810,00:27:09.510
"If the counter key inside of this
special global variable called",00:27:09.510,00:27:14.150
"$_SESSION is set-- in other words,
if there's some value there--",00:27:14.150,00:27:18.010
"let's get it and store it in a local
variable called $counter.",00:27:18.010,00:27:22.440
"Else, let's assign $counter
the default value of 0.",00:27:22.440,00:27:27.000
"&gt;&gt; Now here's one aspect of PHP that's
both a blessing and a curse.",00:27:27.000,00:27:30.320
PHP is a little sloppy.,00:27:30.320,00:27:32.080
"So whereas in C, what would the
scope of counter have been",00:27:32.080,00:27:35.160
either here or here?,00:27:35.160,00:27:36.725
"&gt;&gt; It would have been confined
to those curly braces.",00:27:39.270,00:27:41.690
Guess what?,00:27:41.690,00:27:42.090
"In PHP, it exists even outside of those
curly braces, here, and here,",00:27:42.090,00:27:46.920
"and here, and here, and
even down below.",00:27:46.920,00:27:49.120
"So I say this is a blessing in the sense
that you don't have to think as",00:27:49.120,00:27:52.400
hard as we did weeks ago.,00:27:52.400,00:27:54.070
"But it's also a bit of a curse in that
no matter where you use a variable in",00:27:54.070,00:27:56.880
"PHP, at least in a program like this,
it's globally accessible for",00:27:56.880,00:28:00.020
better or for worse.,00:28:00.020,00:28:01.170
"So you have to keep in mind now that
your variables may not be undefined.",00:28:01.170,00:28:06.130
You might have defined them elsewhere.,00:28:06.130,00:28:07.640
&gt;&gt; But what am I going to do ultimately?,00:28:07.640,00:28:09.460
"I'm going to store inside of that global
variable as a value of the",00:28:09.460,00:28:13.160
"counter key the result of
doing counter plus 1.",00:28:13.160,00:28:17.060
"So this is just the arithmetic
that does the",00:28:17.060,00:28:18.910
incrementation of that counter.,00:28:18.910,00:28:20.590
"And the fact that I'm storing that
value back in here is means to",00:28:20.590,00:28:24.850
"essentially update the database to
remember that user 123456789 has been",00:28:24.850,00:28:29.970
here two times.,00:28:29.970,00:28:31.010
"And when I do it again the next time I
reload the page, it's going to check",00:28:31.010,00:28:33.780
"my hand stamp and say, oh,
user 123456789 has now",00:28:33.780,00:28:36.710
been here three times.,00:28:36.710,00:28:38.410
"&gt;&gt; And so what PHP and similar languages
are doing for us is they are figuring",00:28:38.410,00:28:43.390
"out how and where and for how long
to store values in this special",00:28:43.390,00:28:47.720
superglobal.,00:28:47.720,00:28:48.830
"And this superglobal the next time I
visit the page is sort of magically",00:28:48.830,00:28:52.750
"pre-populated, filled with values that
were there the last time you visited,",00:28:52.750,00:28:57.440
"whether that was a second ago, a week
ago, or in 2013 and we're now talking",00:28:57.440,00:29:02.310
about 2015.,00:29:02.310,00:29:03.790
"PHP and the web server take care
of all of that for you.",00:29:03.790,00:29:07.600
&gt;&gt; AUDIENCE: [INAUDIBLE].,00:29:07.600,00:29:08.850
"&gt;&gt; DAVID MALAN: Variables in PHP are
essentially always global unless you",00:29:11.900,00:29:15.760
"declare them inside of a function,
and then they are local to",00:29:15.760,00:29:18.400
the function only.,00:29:18.400,00:29:19.420
"But because I've not written any
functions, they are now effectively",00:29:19.420,00:29:22.300
global throughout my whole file here.,00:29:22.300,00:29:25.090
"&gt;&gt; AUDIENCE: Is there a way
to make them local?",00:29:25.090,00:29:26.040
"&gt;&gt; DAVID MALAN: Is there any
way to make them local?",00:29:26.040,00:29:28.470
Only by wrapping them into functions.,00:29:28.470,00:29:30.680
"Which in the latest version of
PHP, you can do this with",00:29:30.680,00:29:32.790
an anonymous function.,00:29:32.790,00:29:34.130
"But more on that in the
context of JavaScript.",00:29:34.130,00:29:35.930
But the short answer is no.,00:29:35.930,00:29:37.260
A longer answer is yes.,00:29:37.260,00:29:40.888
Nice.,00:29:40.888,00:29:42.380
Good quiz question.,00:29:42.380,00:29:43.380
All right.,00:29:43.380,00:29:43.930
"&gt;&gt; So lastly, the page itself is
actually pretty simple.",00:29:43.930,00:29:47.760
"Notice that once I exit PHP mode, recall
that all of this stuff down",00:29:47.760,00:29:51.470
"below is just going to get spit
out raw to the browser.",00:29:51.470,00:29:53.700
"Which is fine, because I do want to send
the user some HTML, but I do want",00:29:53.700,00:29:57.050
to dynamically update that HTML.,00:29:57.050,00:29:59.140
"And one way I can do this is to sort
of very quickly drop back into PHP",00:29:59.140,00:30:03.930
"mode, use open bracket question mark
equal sign, and then output the value",00:30:03.930,00:30:07.730
of counter.,00:30:07.730,00:30:08.650
"&gt;&gt; Or if this looks a little cryptic, this
equal sign is actually just some",00:30:08.650,00:30:12.360
"syntactic sugar for this
printf($counter).",00:30:12.360,00:30:16.190
"But frankly, that's just a little ugly
and a little annoying to type.",00:30:16.190,00:30:19.160
"So PHP very nicely offers this feature
where you can just say it more",00:30:19.160,00:30:23.660
succinctly in the same way.,00:30:23.660,00:30:25.450
"&gt;&gt; So what's going on underneath
the hood?",00:30:25.450,00:30:26.940
"Let's quickly look at the network
tab here for counter.php.",00:30:26.940,00:30:31.210
"And let me go ahead and first
let's clear your cookies.",00:30:31.210,00:30:35.090
"Let's clear browsing data since
the beginning of time.",00:30:35.090,00:30:38.670
Now let's go back over here.,00:30:38.670,00:30:39.680
Now let's reload the page.,00:30:39.680,00:30:41.340
And I'm back at zero.,00:30:41.340,00:30:42.170
"Because my hand stamp has been washed,
I now get a new cookie.",00:30:42.170,00:30:44.810
"&gt;&gt; Indeed if I look at the network tab and
look at response headers, notice",00:30:44.810,00:30:48.780
"that the appliance is sending me
a cookie whose name is somewhat",00:30:48.780,00:30:51.960
"arbitrarily, but kind of
reasonably, PHPSESSID.",00:30:51.960,00:30:55.820
"And it's sending me this really
big random number.",00:30:55.820,00:30:58.440
It's not quite a number.,00:30:58.440,00:30:59.440
It's not quite hexadecimal.,00:30:59.440,00:31:00.390
"It's some kind of alphanumeric string,
but presumably it's random.",00:31:00.390,00:31:03.600
"And that is the hand stamp so to
speak that I'm referring to.",00:31:03.600,00:31:06.830
"&gt;&gt; Meanwhile if I click reload and then
look at this second line for my second",00:31:06.830,00:31:11.960
"request, notice now that my request
headers include PHPSESSID equals this,",00:31:11.960,00:31:17.600
"not set-cookie, but just cookie.",00:31:17.600,00:31:19.390
"And that's my browser's presentation
of my hand stamp.",00:31:19.390,00:31:22.950
"&gt;&gt; So now as a teaser, and we'll talk more
about this in a week or so, but",00:31:22.950,00:31:28.820
"in what way does this make you
vulnerable, your Facebook account",00:31:28.820,00:31:31.590
"vulnerable, and other such
accounts vulnerable?",00:31:31.590,00:31:34.137
&gt;&gt; AUDIENCE: If somebody has your cookie.,00:31:34.137,00:31:35.510
"&gt;&gt; DAVID MALAN: Yeah, if someone
has your cookie.",00:31:35.510,00:31:36.750
"I mean truly, much like some of you
might have tried at like a club or an",00:31:36.750,00:31:39.920
"amusement park, if you try something
like this to copy the stamp, albeit",00:31:39.920,00:31:44.030
"backwards onto another person's hand,
and then he or she presents it as",00:31:44.030,00:31:47.560
"their own, if it actually does look
identical, 123456789, then the web",00:31:47.560,00:31:53.250
"server is apparently just going to
trust that that user is you.",00:31:53.250,00:31:57.980
"&gt;&gt; And this is indeed a fundamental
threat any time you use cookies",00:31:57.980,00:32:01.450
"because if someone just spoofs so to
speak your cookie, figures out what it",00:32:01.450,00:32:05.420
"is, either by truly copying it
by looking at your computer",00:32:05.420,00:32:08.660
"and being like, OK.",00:32:08.660,00:32:09.890
"David's cookie is JJ3JIK and so forth,
and then they're smart enough to know",00:32:09.890,00:32:14.520
"how to sort of manually send that
cookie from a browser or from a",00:32:14.520,00:32:18.080
"program they write, they could totally
log into a website as you.",00:32:18.080,00:32:22.350
"It is not that hard to pretend to be
someone else unless we revisit p-set",00:32:22.350,00:32:28.560
"two, which introduced what?",00:32:28.560,00:32:30.790
&gt;&gt; AUDIENCE: Cryptography.,00:32:30.790,00:32:32.065
"&gt;&gt; DAVID MALAN: A little
bit of cryptography.",00:32:32.065,00:32:33.860
"Simple cryptography, at least in the
standard edition, but crypto",00:32:33.860,00:32:36.550
nonetheless.,00:32:36.550,00:32:36.870
less.,00:32:36.870,00:32:37.410
"So it turns out if you encrypt all of
these headers using something that you",00:32:37.410,00:32:41.440
"might now know more familiarly as SSL,
secure socket layer, or https:// URLs,",00:32:41.440,00:32:48.770
"then all of these things we've been
glancing at are actually encrypted,",00:32:48.770,00:32:51.890
"which means that it's like you
can't read the hand stamp.",00:32:51.890,00:32:54.800
"Only facebook.com can, or google.com,
or in this case, the appliance can",00:32:54.800,00:32:59.350
read that hand stamp.,00:32:59.350,00:33:00.550
"&gt;&gt; Tragically though, and again, this is
all too appropriate with the NSA stuff",00:33:00.550,00:33:04.020
"of late, even SSL is breakable.",00:33:04.020,00:33:06.410
"And it's actually not that hard
to even crack that encryption.",00:33:06.410,00:33:09.850
"Not so much by cracking the encryption,
but by tricking the",00:33:09.850,00:33:12.040
"browser into decrypting
the data prematurely.",00:33:12.040,00:33:15.720
"But again, we'll tease you
with that before long.",00:33:15.720,00:33:17.880
"For now, just be afraid.",00:33:17.880,00:33:21.242
It's tragically kind of true.,00:33:21.242,00:33:23.070
&gt;&gt; All right.,00:33:23.070,00:33:23.760
"So, where does this now leave us?",00:33:23.760,00:33:27.910
"Well, let's do this.",00:33:27.910,00:33:29.010
"Let's go ahead and take a quick
teaser before we take a break.",00:33:29.010,00:33:31.790
"And I think we'll linger a bit longer
today, but we're going to dive into",00:33:31.790,00:33:33.790
"something brand new and sexy, which will
whet your appetite for even more.",00:33:33.790,00:33:37.850
So that's the teaser.,00:33:37.850,00:33:38.950
"&gt;&gt; So SQL, we started talking about
ever so briefly last time.",00:33:38.950,00:33:41.520
"You'll really get your hands dirty
with some of it in p-set seven.",00:33:41.520,00:33:44.670
"And in layman's terms, what does SQL--",00:33:44.670,00:33:46.480
S-Q-L--,00:33:46.480,00:33:47.110
do for you?,00:33:47.110,00:33:49.850
What is it?,00:33:49.850,00:33:50.310
Yeah.,00:33:50.310,00:33:51.546
&gt;&gt; AUDIENCE: Let's you access data.,00:33:51.546,00:33:53.240
&gt;&gt; DAVID MALAN: Yeah.,00:33:53.240,00:33:53.360
"It let's you access data
in a database.",00:33:53.360,00:33:55.120
Structured Query Language.,00:33:55.120,00:33:56.710
"And this is essentially a
programming language.",00:33:56.710,00:33:59.890
"There are features of it that
we won't even use in class.",00:33:59.890,00:34:03.400
"But you can effectively
define functions.",00:34:03.400,00:34:04.710
"They're called stored
procedures in SQL.",00:34:04.710,00:34:06.870
"But we'll keep it fairly simple and just
use it for some basic operations",00:34:06.870,00:34:09.860
"like selecting data, inserting data,
updating data, and deleting data.",00:34:09.860,00:34:14.320
"&gt;&gt; And you can really think of a database,
like a SQL database, as just",00:34:14.320,00:34:17.400
being Microsoft Excel.,00:34:17.400,00:34:18.800
"Because SQL refers to a relational
database, where",00:34:18.800,00:34:21.989
relation just means tables.,00:34:21.989,00:34:23.480
Rows and columns.,00:34:23.480,00:34:24.739
"So anything you can put in a spreadsheet
like this or Google Docs,",00:34:24.739,00:34:27.929
"you could put into a SQL database
by declaring a table.",00:34:27.929,00:34:32.460
"&gt;&gt; Now, how do you actually access
that information?",00:34:32.460,00:34:34.800
"Well, with commands or
queries like this.",00:34:34.800,00:34:38.239
"SELECT, INSERT, UPDATE, and DELETE.",00:34:38.239,00:34:40.199
"And for the most part, those are the
four only ingredients you'll need to",00:34:40.199,00:34:44.489
"do something quite powerfully
in problem set seven.",00:34:44.489,00:34:47.370
"&gt;&gt; Now back in the day, you would actually
interact with a database in a",00:34:47.370,00:34:49.940
"black and white terminal window at
a blinking prompt like this.",00:34:49.940,00:34:52.730
"And the database we're running on the
appliance is called MySQL, which is",00:34:52.730,00:34:56.370
free and open source database engine.,00:34:56.370,00:34:58.560
"If you Google and read the Wikipedia
article, you'll know that the name is",00:34:58.560,00:35:02.240
"a bit of transition for some
versions of Linux.",00:35:02.240,00:35:05.060
"Maria database is actually a
fork so to speak of MySQL.",00:35:05.060,00:35:10.460
"&gt;&gt; Long story short, Oracle bought MySQL.",00:35:10.460,00:35:12.740
Oracle's a big company.,00:35:12.740,00:35:13.870
"People have been worried that it would
no longer remain quite as open source,",00:35:13.870,00:35:17.010
"so this is just a copy of MySQL that's
still free, still open source, and",00:35:17.010,00:35:20.930
installed in Fedora Linux by default.,00:35:20.930,00:35:23.550
"&gt;&gt; But this is kind of a pain in the
neck to get acquainted with a",00:35:23.550,00:35:26.130
database this way.,00:35:26.130,00:35:27.310
"So we include in the CS50 appliance
a free open source tool called",00:35:27.310,00:35:30.560
phpMyAdmin.,00:35:30.560,00:35:31.700
"Just a coincidence that
it's written in PHP.",00:35:31.700,00:35:33.940
"There's no fundamental
need for PHP here.",00:35:33.940,00:35:36.450
"But this is just a web-based tool that
we downloaded for free, installed in",00:35:36.450,00:35:40.090
"the appliance, that allows us to have a
graphical user interface with which",00:35:40.090,00:35:43.850
"to explore the p-set seven database with
which to create new databases,",00:35:43.850,00:35:48.610
"say for your own final project if you'd
like, and ultimately create",00:35:48.610,00:35:51.980
"dynamic websites like CS50 Finance
that allow you to query data and",00:35:51.980,00:35:55.900
update data dynamically.,00:35:55.900,00:35:58.140
"&gt;&gt; You're not going to have to use just
a simple text file or CSV.",00:35:58.140,00:36:01.420
"You can actually use a smart database
program so that you can execute more",00:36:01.420,00:36:05.950
"sophisticated queries than just reading
through everything linearly.",00:36:05.950,00:36:10.240
"&gt;&gt; So for instance, this is what we give
you out of the box for p-set seven.",00:36:10.240,00:36:14.150
"This is a table with apparently at least
three columns, one of which is",00:36:14.150,00:36:18.280
"username, one of which is hash,
and the other of which is ID.",00:36:18.280,00:36:21.450
"&gt;&gt; But the interesting thing, and just to
tease out one thought here, username",00:36:21.450,00:36:26.200
"is presumably already unique, right?",00:36:26.200,00:36:29.270
"I mean, most any website, if
you have a username, there",00:36:29.270,00:36:31.190
can't be two caesars.,00:36:31.190,00:36:32.370
There can't be two malans.,00:36:32.370,00:36:33.440
There can't be two jharvards.,00:36:33.440,00:36:34.950
Its unique.,00:36:34.950,00:36:35.600
"Otherwise, they don't know which
jharvard it actually is.",00:36:35.600,00:36:38.610
"So what might be the motivation for also
having a third column on the left",00:36:38.610,00:36:42.710
"there called ID, which looks like a
number that's similarly unique?",00:36:42.710,00:36:46.970
"It feels a little redundant
to me at first glance.",00:36:46.970,00:36:51.300
"Why might it be compelling to have
not only unique usernames,",00:36:51.300,00:36:54.910
but also unique numbers?,00:36:54.910,00:36:56.837
"&gt;&gt; AUDIENCE: They could have
the same password.",00:36:56.837,00:36:59.460
"&gt;&gt; DAVID MALAN: People might have
the same password, sure.",00:36:59.460,00:37:01.720
That could absolutely happen.,00:37:01.720,00:37:03.900
"But if they have this unique username, I
would argue that that doesn't really",00:37:03.900,00:37:08.270
"matter, because if they type in their
username, I only need to check their",00:37:08.270,00:37:11.630
"password, their hash thereof.",00:37:11.630,00:37:15.060
Why else?,00:37:15.060,00:37:15.970
&gt;&gt; AUDIENCE: Faster searching.,00:37:15.970,00:37:17.950
&gt;&gt; DAVID MALAN: Faster searching.,00:37:17.950,00:37:18.680
Why?,00:37:18.680,00:37:19.548
&gt;&gt; AUDIENCE: ID is just one.,00:37:19.548,00:37:21.460
"&gt;&gt; DAVID MALAN: ID is just one character,
or to be more precise, it's a number,",00:37:21.460,00:37:24.040
"so it's probably 32 bits
or something like that.",00:37:24.040,00:37:26.910
"Whereas the username, apparently Jason
Hirschhorn's up there is sort of",00:37:26.910,00:37:30.270
"ridiculously long, and it's going to
take me a lot more time to string",00:37:30.270,00:37:33.900
"compare H-I-R-S-C-H-H-O-R-N, and maybe
a /0 or something like that, in order",00:37:33.900,00:37:40.910
"to look up Jason, as opposed to just
saying give me user number two.",00:37:40.910,00:37:45.100
That's 32 bits.,00:37:45.100,00:37:46.510
"It's a single INT that
you have to compare.",00:37:46.510,00:37:48.550
"And indeed, that's exactly why databases
tend to assign unique IDs to",00:37:48.550,00:37:52.150
rows in them.,00:37:52.150,00:37:53.710
"&gt;&gt; Now what other data types are there
besides INT and apparently",00:37:53.710,00:37:56.280
strings like this?,00:37:56.280,00:37:57.160
"Well, to be more proper,
SQL databases, like",00:37:57.160,00:37:59.700
"MySQL, have CHAR fields.",00:37:59.700,00:38:02.060
"And CHAR a little misleadingly
is not a single CHAR.",00:38:02.060,00:38:05.320
"A CHAR field in a MySQL database is
one or more characters, but it's a",00:38:05.320,00:38:10.290
fixed number of characters.,00:38:10.290,00:38:11.780
"&gt;&gt; So for instance, if I go over to
phpMyAdmin as you may have already, or",00:38:11.780,00:38:15.710
"soon will a problem set seven, and I go
to my database, and just for fun,",00:38:15.710,00:38:21.340
"let's create a new table called
test with just two columns.",00:38:21.340,00:38:25.700
I'll then click Go.,00:38:25.700,00:38:27.160
"And this will become fairly familiar,
especially as you tinker",00:38:27.160,00:38:30.070
around on your own.,00:38:30.070,00:38:31.130
"Here I might type ID to create
a new table of type INT.",00:38:31.130,00:38:34.140
"But here I might type username to
recreate that earlier table.",00:38:34.140,00:38:37.770
"And notice I have a whole bunch
of types to choose from.",00:38:37.770,00:38:40.700
"&gt;&gt; And this too is why phpMyAdmin
is kind of nice.",00:38:40.700,00:38:43.610
"It's kind of self-teaching in that you
can just kind of point, and click, and",00:38:43.610,00:38:46.770
"look at dropdown menus, and infer from
that what powers SQL gives you.",00:38:46.770,00:38:50.730
"&gt;&gt; And indeed, if I choose CHAR, I then
have to specify the length, or how",00:38:50.730,00:38:54.090
"many values, how many CHARs.",00:38:54.090,00:38:55.940
"So very common values are things like
255, but that's a little long.",00:38:55.940,00:39:00.090
Commonly is eight for a username.,00:39:00.090,00:39:02.250
But that's a little small these days.,00:39:02.250,00:39:03.590
So this is a design decision.,00:39:03.590,00:39:05.430
"Is it 8 characters max,
32, 255, 1,000?",00:39:05.430,00:39:08.630
It's really up to you.,00:39:08.630,00:39:09.830
But a CHAR field is a fixed number.,00:39:09.830,00:39:12.350
"So choose too few and you're kind of
screwed if you want a longer username.",00:39:12.350,00:39:16.420
"Choose too many and what's
the downside?",00:39:16.420,00:39:19.132
&gt;&gt; AUDIENCE: [INAUDIBLE].,00:39:19.132,00:39:20.820
&gt;&gt; DAVID MALAN: It's wasteful.,00:39:20.820,00:39:21.620
"Just like in C, if you have a bigger
chunk of memory than you need, you're",00:39:21.620,00:39:24.835
just wasting time and wasting space.,00:39:24.835,00:39:27.190
"So as an alternative, there exists
VARCHAR, which solves this problem by",00:39:27.190,00:39:31.430
"treating length not as a fixed length,
but as a maximum length, and using a",00:39:31.430,00:39:36.390
"variable number of CHARs, which then
tends to use only as many CHARs as you",00:39:36.390,00:39:40.990
actually need.,00:39:40.990,00:39:42.710
That sounds perfect.,00:39:42.710,00:39:43.670
"&gt;&gt; Why don't we get rid of the
CHAR data type then?",00:39:43.670,00:39:45.640
"What might be the downside of
using VARCHARs, which sounds",00:39:45.640,00:39:48.500
like it's a nice win?,00:39:48.500,00:39:51.644
Yeah?,00:39:51.644,00:39:52.596
&gt;&gt; AUDIENCE: [INAUDIBLE].,00:39:52.596,00:39:53.846
"&gt;&gt; DAVID MALAN: OK, good.",00:39:57.360,00:39:57.790
"So if all of your data is the same
length, what's the concern?",00:39:57.790,00:40:01.101
"&gt;&gt; AUDIENCE: Because you're wasting
data by telling them all.",00:40:01.101,00:40:05.250
"&gt;&gt; DAVID MALAN: So if all of your data is
the same length, though, I would argue",00:40:05.250,00:40:09.060
"that specifying a maximum length
on VARCHAR is no different from",00:40:09.060,00:40:12.300
"specifying a fixed length on CHAR if
you know that number in advance.",00:40:12.300,00:40:16.070
"But there is indeed, and I'll sort of
extract from that answer the reality",00:40:16.070,00:40:19.500
"that there's still a max, which could
be annoying, especially if you",00:40:19.500,00:40:22.610
"encounter a person's name that's
unusually long that you didn't",00:40:22.610,00:40:25.920
anticipate.,00:40:25.920,00:40:26.860
"And it's also a little less efficient
to actually search on VARCHARs as",00:40:26.860,00:40:31.420
"opposed to searching CHARs, especially
for long tables that have lots and",00:40:31.420,00:40:35.620
lots of data.,00:40:35.620,00:40:36.510
"So here too, thematic is again
no obvious choice.",00:40:36.510,00:40:40.060
"&gt;&gt; So just to give you a sense of other
data types that might be of interest",00:40:40.060,00:40:42.870
"either for p-set seven or in
the future, there's INT.",00:40:42.870,00:40:45.400
"There's BIGINT, which
is like long long.",00:40:45.400,00:40:47.270
It tends to be 64 bits.,00:40:47.270,00:40:48.880
"There's DECIMAL, which you'll see in
the problem set, which is a much",00:40:48.880,00:40:51.640
"cleaner answer to the problems we
encountered with float and floating",00:40:51.640,00:40:55.300
point imprecision.,00:40:55.300,00:40:55.980
And then there's DATETIME.,00:40:55.980,00:40:57.390
"There's literally a data type that has
to look like a year, a month, a day,",00:40:57.390,00:41:01.530
"and an hour, minute, and second.",00:41:01.530,00:41:03.730
"&gt;&gt; But SQL databases also have
things we'll call indexes.",00:41:03.730,00:41:07.470
"And an index is something that you
specify when creating the table to",00:41:07.470,00:41:11.630
"make searches and other operations
more efficient.",00:41:11.630,00:41:15.720
"Specifically, there's something called
the PRIMARY index that you could",00:41:15.720,00:41:18.550
declare as follows.,00:41:18.550,00:41:19.440
"&gt;&gt; We did this for you with the
users table we give you.",00:41:19.440,00:41:22.330
"But notice if I were manually recreating
the users table here giving",00:41:22.330,00:41:26.160
it a name of users.,00:41:26.160,00:41:27.110
I already specified ID.,00:41:27.110,00:41:28.125
I specified INT.,00:41:28.125,00:41:29.330
"I specified username with
maximum 32 characters.",00:41:29.330,00:41:32.000
"But if we keep scrolling in this fairly
wide window, notice there's a",00:41:32.000,00:41:36.140
bunch of other things I can specify.,00:41:36.140,00:41:38.260
"&gt;&gt; One, I can specify attributes
like, you know what, this",00:41:38.260,00:41:40.950
INT should be UNSIGNED.,00:41:40.950,00:41:42.190
"I don't want negative numbers,
so let's make it UNSIGNED.",00:41:42.190,00:41:45.510
"Null is not relevant here because
I do want every user to",00:41:45.510,00:41:48.660
have a unique number.,00:41:48.660,00:41:49.640
I don't want it to be null.,00:41:49.640,00:41:50.830
&gt;&gt; But this is interesting.,00:41:50.830,00:41:52.330
"I can specify that ID is either the
primary key of this database, or it's",00:41:52.330,00:41:57.780
"unique, or it's indexed, or full text.",00:41:57.780,00:42:00.620
"So for today's purposes, long story
short, PRIMARY means that this shall",00:42:00.620,00:42:05.630
"be both conceptually and technically
the field that we use to uniquely",00:42:05.630,00:42:10.570
identify users.,00:42:10.570,00:42:12.140
"&gt;&gt; So when we look up users, this is sort
of a promise to look them up mostly by",00:42:12.140,00:42:16.140
that unique identifier.,00:42:16.140,00:42:17.370
"And the database will ensure that if you
have a user number 3, you cannot",00:42:17.370,00:42:21.930
"physically insert another user
with that same number 3.",00:42:21.930,00:42:25.400
"The database will just refuse
to save your changes.",00:42:25.400,00:42:28.380
"Which is a good thing, because you can
protect yourself from yourself. self",00:42:28.380,00:42:32.310
"&gt;&gt; Alternatively, for username.",00:42:32.310,00:42:34.270
"So the second row, recall,
is the username field.",00:42:34.270,00:42:37.670
"So the second row here is username,
as we did on the far left there.",00:42:37.670,00:42:41.860
&gt;&gt; So what else might I want to specify?,00:42:41.860,00:42:43.940
"I'm not allowed, according to SQL,
to specify two primary keys.",00:42:43.940,00:42:47.840
"you can specify a joint key where you
look at both fields, but they can't",00:42:47.840,00:42:50.750
individually be primary keys.,00:42:50.750,00:42:52.260
So that's out of the question.,00:42:52.260,00:42:54.750
So which might I want to choose?,00:42:54.750,00:42:56.040
"&gt;&gt; Well, UNIQUE is similar in spirit to a
primary key where you specify this",00:42:56.040,00:42:59.710
"field shall be unique, but it's
not going to be the one",00:42:59.710,00:43:03.570
I use all the time.,00:43:03.570,00:43:04.410
"And we're not going to use this one all
the time for what reason again?",00:43:04.410,00:43:08.450
"It's slower potentially if
it's a long username.",00:43:08.450,00:43:10.490
It's just a waste of time.,00:43:10.490,00:43:11.740
"&gt;&gt; INDEX, meanwhile, specifies that it's
not going to be unique, but I'd like",00:43:11.740,00:43:16.140
"you to work your magic underneath the
hood to make it faster for me to",00:43:16.140,00:43:19.470
search on this field.,00:43:19.470,00:43:21.420
So this probably isn't relevant here.,00:43:21.420,00:43:23.320
"For username, I'd argue that
UNIQUE is a good answer.",00:43:23.320,00:43:26.500
"But suppose that we made users more
interesting than just usernames,",00:43:26.500,00:43:31.200
"hashes, and ID numbers.",00:43:31.200,00:43:32.430
What if we gave people full names?,00:43:32.430,00:43:33.860
"What if we gave them addresses
and other data about them?",00:43:33.860,00:43:37.700
"&gt;&gt; Well, if you specify that a column in a
database is indexed, that means that",00:43:37.700,00:43:43.360
"MySQL, or Oracle, or whatever database
you're using, should work its magic",00:43:43.360,00:43:47.730
"and use some kind of fancy data
structure like a tree, or a trie, or a",00:43:47.730,00:43:51.300
"hash table, or something to guarantee
that when you search for data using",00:43:51.300,00:43:55.940
select on that particular field--,00:43:55.940,00:43:58.150
"like show me everyone that
lives on Oxford Street.",00:43:58.150,00:44:01.310
A query like that.,00:44:01.310,00:44:02.540
"If you have specified in advance that
you want an index on that field, the",00:44:02.540,00:44:06.250
"searches will be much, much faster.",00:44:06.250,00:44:09.050
"&gt;&gt; If you don't specify an index, the best
you can do is a linear search if",00:44:09.050,00:44:12.090
it's not sorted.,00:44:12.090,00:44:13.030
"But if you specify INDEX, the smart
people who made the database--",00:44:13.030,00:44:16.220
"people like you who now know trees
and tries and hash tables--",00:44:16.220,00:44:19.340
"will automatically build such a data
structure in RAM to make sure that",00:44:19.340,00:44:23.220
those searches are much faster.,00:44:23.220,00:44:26.050
"&gt;&gt; FULLTEXT meanwhile is similar in spirit,
but allows you to do wildcard",00:44:26.050,00:44:29.660
"searches, like show me everyone that
lives at streets that begin with the",00:44:29.660,00:44:35.480
letter O for whatever reason.,00:44:35.480,00:44:36.960
"You can do wildcard searches
like that.",00:44:36.960,00:44:38.850
"Or, more compelling things like show
me everyone who has the word--",00:44:38.850,00:44:45.880
"show me everyone whose name starts
with a particular letter.",00:44:45.880,00:44:49.400
"You can search for keywords
in this way.",00:44:49.400,00:44:51.880
All right.,00:44:51.880,00:44:52.630
"&gt;&gt; So, design opportunities
there potentially.",00:44:52.630,00:44:55.760
"There are others that I'll
wave my hands at.",00:44:55.760,00:44:57.740
"It turns out that you can have
different storage engines.",00:44:57.740,00:45:00.530
"And this is more arcane than we need
certainly for problem set seven.",00:45:00.530,00:45:04.390
"By default, you guys are using
something called InnoDB.",00:45:04.390,00:45:06.920
"You'll see mention of this somewhere in
phpMyAdmin's interface most likely.",00:45:06.920,00:45:10.910
"But know that there are other design
decisions that are of potential",00:45:10.910,00:45:14.130
"interest come final projects if
you do something web-based.",00:45:14.130,00:45:18.030
&gt;&gt; But let's do this.,00:45:18.030,00:45:19.330
"Let's go ahead and put this on the
screen as a teaser for a story",00:45:19.330,00:45:23.130
"involving you, a roommate,
and a glass of milk.",00:45:23.130,00:45:26.330
"Let's take a two minute
or so break here.",00:45:26.330,00:45:28.240
"And if you can stick around, let's come
back, look a bit more at SQL, and",00:45:28.240,00:45:31.060
"then a bit of JavaScript with
p-set eight in mind.",00:45:31.060,00:45:35.160
&gt;&gt; All right.,00:45:35.160,00:45:36.120
"So, let's get you thinking about a
corner case that can very easily arise",00:45:36.120,00:45:40.420
"in the context of using a database, or
frankly, even using real world things",00:45:40.420,00:45:44.240
like ATMs to get money.,00:45:44.240,00:45:46.280
So here's a refrigerator.,00:45:46.280,00:45:47.640
"Suppose you've got one too in
your dorm or your house.",00:45:47.640,00:45:50.040
"And you've got one roommate, and both of
you really like milk for instance.",00:45:50.040,00:45:54.990
&gt;&gt; So you come home from class one day.,00:45:54.990,00:45:57.210
He or she's not yet back.,00:45:57.210,00:45:58.490
You open the fridge.,00:45:58.490,00:45:59.180
You really want a big glass of milk.,00:45:59.180,00:46:00.870
There's no milk.,00:46:00.870,00:46:01.820
So what do you do?,00:46:01.820,00:46:02.920
You close the fridge.,00:46:02.920,00:46:03.840
You grab your keys.,00:46:03.840,00:46:04.670
You go out to the square.,00:46:04.670,00:46:05.930
"And you get in line at CVS at those
self checkout things, which always",00:46:05.930,00:46:09.240
"take longer than actually
having cashiers.",00:46:09.240,00:46:11.180
Anyhow.,00:46:11.180,00:46:11.820
"&gt;&gt; So then, meanwhile, dot dot dot, your
roommate comes home and he or she",00:46:11.820,00:46:15.490
"similarly has a hankering
for some milk.",00:46:15.490,00:46:17.440
"So he or she opens the fridge,
looks inside, and oh, damn.",00:46:17.440,00:46:20.380
No milk.,00:46:20.380,00:46:21.160
"So he or she heads out, happens to go
to the other CVS, which was only a",00:46:21.160,00:46:24.750
"block away for some reason, and he or
she gets in line to buy some milk.",00:46:24.750,00:46:27.900
"&gt;&gt; Meanwhile, you come home, he or
she comes home, and what do",00:46:27.900,00:46:30.480
you ultimately have?,00:46:30.480,00:46:31.980
Twice as much milk.,00:46:31.980,00:46:33.080
"But you don't really like
milk that much.",00:46:33.080,00:46:34.620
"So now you have so much milk that now
one of them is just going to go sour",00:46:34.620,00:46:37.300
eventually.,00:46:37.300,00:46:37.820
So this is a really bad problem.,00:46:37.820,00:46:39.370
Right?,00:46:39.370,00:46:39.900
&gt;&gt; So what has happened?,00:46:39.900,00:46:41.990
"So fundamentally, this is kind
of a ridiculous example.",00:46:41.990,00:46:44.810
"But underneath the hood, what we've had
happen here is both of you checked",00:46:44.810,00:46:48.580
"the state of some piece of
memory, the refrigerator.",00:46:48.580,00:46:52.390
"Both of you checked the state
of some variable.",00:46:52.390,00:46:54.420
"You both drew a conclusion
that you then acted on.",00:46:54.420,00:46:57.360
"But unfortunately, while your roommate
was at the store, the state of that",00:46:57.360,00:47:01.420
"variable changed, he or she came back
and now wants to change the state, but",00:47:01.420,00:47:05.670
"it's already been changed
on him or her.",00:47:05.670,00:47:07.480
"And of course, he or she would not have
gone to the store if they knew",00:47:07.480,00:47:11.120
that you were already en route.,00:47:11.120,00:47:13.010
"&gt;&gt; So in the real world, how could you
avoid this problem, assuming you have",00:47:13.010,00:47:16.430
"a fridge, you have a roommate,
and you actually like milk?",00:47:16.430,00:47:18.940
&gt;&gt; AUDIENCE: Communicating.,00:47:18.940,00:47:19.760
&gt;&gt; DAVID MALAN: Communicating.,00:47:19.760,00:47:20.580
OK.,00:47:20.580,00:47:21.160
But how might you communicate?,00:47:21.160,00:47:22.500
&gt;&gt; AUDIENCE: Leave a note.,00:47:22.500,00:47:23.990
"&gt;&gt; DAVID MALAN: Leave a note, right?",00:47:23.990,00:47:25.480
"Always leave a note, for
fans of the show.",00:47:25.480,00:47:28.025
"All right, so always leave a note, or
put truly like a padlock or something",00:47:28.025,00:47:31.580
"on the refrigerator that keeps your
roommate from inspecting the state of",00:47:31.580,00:47:35.440
that variable.,00:47:35.440,00:47:36.540
"&gt;&gt; Now, why might this be germane to
problem set seven, or to ATMs.",00:47:36.540,00:47:40.800
"Well, imagine a world in an ATM where
you might be able to go up to an ATM",00:47:40.800,00:47:46.780
"machine here, and another ATM here.",00:47:46.780,00:47:48.920
And this happens quite often.,00:47:48.920,00:47:50.680
"And suppose you had two ATM cards,
which is possible to obtain.",00:47:50.680,00:47:54.150
"And you log into both machines
effectively simultaneously, hopefully",00:47:54.150,00:47:57.420
while no one's looking.,00:47:57.420,00:47:58.660
"And then you type in your PIN
roughly simultaneously.",00:47:58.660,00:48:01.260
"And then you do a balance query
to see how much cash you have.",00:48:01.260,00:48:06.280
"And let's say you have $100
left in your account.",00:48:06.280,00:48:08.920
"So essentially simultaneously, you
say one, zero, zero, enter.",00:48:08.920,00:48:13.310
And you hopefully get back some money.,00:48:13.310,00:48:16.000
&gt;&gt; But how much money might you get back?,00:48:16.000,00:48:18.440
"Now computers at the end of the day,
especially if they're talking to",00:48:18.440,00:48:21.710
"servers, don't necessarily do things
in the order that's expected.",00:48:21.710,00:48:27.360
"&gt;&gt; So suppose what happens, because of
whatever network speed issues there",00:48:27.360,00:48:30.860
"are, or CPU issues there are, or
anything like that, suppose that the",00:48:30.860,00:48:34.530
"first ATM checks your balance and
sees, oh, this person has $100.",00:48:34.530,00:48:38.530
"But then gets distracted because maybe
a backup is happening and so it's",00:48:38.530,00:48:41.840
slowing down.,00:48:41.840,00:48:42.500
"Or maybe while checking, the network
connection got a little slower because",00:48:42.500,00:48:45.080
this just happens.,00:48:45.080,00:48:45.910
They're physical devices.,00:48:45.910,00:48:47.100
"So meanwhile, the second ATM is
asking the same question.",00:48:47.100,00:48:49.330
"How much money does David have?
$100 is the answer.",00:48:49.330,00:48:53.030
"But because the first ATM hasn't yet
sent the message subtract $100, both",00:48:53.030,00:48:58.930
"ATMs have inspected the bank's vault,
seeing there's $100 there, and now",00:48:58.930,00:49:03.000
"both machines potentially are
going to spit out an answer.",00:49:03.000,00:49:07.160
"&gt;&gt; Now, this is great for you in some sense
if what the bank does ultimately",00:49:07.160,00:49:12.240
"is change the amount to minus 100 by
setting the variable equal to your",00:49:12.240,00:49:17.200
"bank account equal to 0, as opposed
to doing minus 100.",00:49:17.200,00:49:21.570
Now in the worst case for the bank--,00:49:21.570,00:49:24.410
"or in the best for the bank, meanwhile,
they give you $200, and",00:49:24.410,00:49:27.470
"your bank account now shows negative
$100, which really doesn't",00:49:27.470,00:49:31.690
benefit you at all.,00:49:31.690,00:49:32.950
"But the point is that this race
condition for two roommates getting",00:49:32.950,00:49:36.500
"milk, or for two ATMs trying to get cash
and change the state of a vault",00:49:36.500,00:49:40.660
"at the same time exists any
time you have a database.",00:49:40.660,00:49:44.510
"&gt;&gt; Now in problem set seven, this issue
arises in the sense that if you buy a",00:49:44.510,00:49:48.290
"share of Facebook stock, and then for
instance you buy a second share of",00:49:48.290,00:49:52.110
"Facebook stock, you need to make
a decision as the programmer.",00:49:52.110,00:49:55.160
"In order to decide how to update the
database, odds are you're going to",00:49:55.160,00:49:58.710
"have one row for that stock, and this
is one way to implement it.",00:49:58.710,00:50:02.250
"And you're going to have one share of
FB, which is their stock ticker symbol",00:50:02.250,00:50:06.640
"for this username, or this user
ID, the unique identifier.",00:50:06.640,00:50:10.120
&gt;&gt; But the same story can happen here.,00:50:10.120,00:50:12.340
"If you do a SELECT in SQL, as you'll see
in problem set seven when you see,",00:50:12.340,00:50:15.800
"oh, David has one share
of Facebook stock.",00:50:15.800,00:50:18.460
"Let me now change this to be two shares,
because he wants to buy a",00:50:18.460,00:50:23.240
second share.,00:50:23.240,00:50:24.120
"But suppose David actually had two
browser windows open, or suppose that",00:50:24.120,00:50:27.860
"it's a joint account with two spouses,
and both of them are trying to perform",00:50:27.860,00:50:32.150
"the same operation, there, too, the
potential exists for a decision to be",00:50:32.150,00:50:36.770
"made based on the previous
state of the world--",00:50:36.770,00:50:39.670
the account has one share--,00:50:39.670,00:50:41.290
"and both people, or both servers, now
try to say increment it to two shares.",00:50:41.290,00:50:45.630
"But in this case, you might have charged
me money for both shares, but",00:50:45.630,00:50:49.020
incremented just that one time.,00:50:49.020,00:50:50.830
"&gt;&gt; So in short, the fundamental problem
here, as with the joke about leaving a",00:50:50.830,00:50:54.730
"note, or putting a padlock on it, is
if two people, or two threads--",00:50:54.730,00:50:58.750
think back to scratch--,00:50:58.750,00:50:59.930
"can inspect the state of some variable
and then try to change that variable,",00:50:59.930,00:51:03.220
"but those two things don't happen at the
same time but can get interrupted",00:51:03.220,00:51:07.950
"by other things happening, data can
get into a very weird state.",00:51:07.950,00:51:11.500
"And you can benefit or you can suffer
in the sense of the money example.",00:51:11.500,00:51:15.450
"&gt;&gt; So in problem set seven, we give you
this one line of code, which long",00:51:15.450,00:51:18.110
"story short, solves this
problem in MySQL.",00:51:18.110,00:51:21.000
"This very long instruction that doesn't
even fit onto one line on the",00:51:21.000,00:51:24.950
"screen here ensures that your operation
is what's called atomic.",00:51:24.950,00:51:30.370
"It all happens at once, or
it doesn't happen at all.",00:51:30.370,00:51:33.720
"This very long phrase cannot
get interrupted partially.",00:51:33.720,00:51:37.530
"&gt;&gt; And what it does is literally
what it says.",00:51:37.530,00:51:39.840
"Insert into some table the following
three fields those specific values,",00:51:39.840,00:51:44.200
"but on duplicate key,
don't do an insert.",00:51:44.200,00:51:47.280
Do an update.,00:51:47.280,00:51:48.280
"So this is like doing a SELECT and an
INSERT so to speak at the same time.",00:51:48.280,00:51:52.450
"And what is the key that's probably
being referred to here?",00:51:52.450,00:51:55.150
"&gt;&gt; It turns out, and you'll see this in
problem set seven's spec, because",00:51:58.300,00:52:01.380
"we've declared there to be a unique key
on this particular table such that",00:52:01.380,00:52:06.040
"you can't have multiple rows
for the same user with the",00:52:06.040,00:52:08.480
same penny stock symbol--,00:52:08.480,00:52:10.150
"in this example here, DVN.V is
a silly penny stock that we",00:52:10.150,00:52:13.780
refer to in the spec.,00:52:13.780,00:52:14.980
"Because we've declared it to be unique,
what this means is that if you",00:52:14.980,00:52:17.860
"try to insert a duplicate row, you're
instead going to update it without",00:52:17.860,00:52:23.580
"anyone else having a chance to change
the state of the world either.",00:52:23.580,00:52:27.020
"So in short, this ensures
things are atomic.",00:52:27.020,00:52:29.400
"&gt;&gt; More generally though, databases
like MySQL--",00:52:29.400,00:52:32.530
"and you don't need this feature for
p-set seven, but keep it in mind for",00:52:32.530,00:52:35.460
the future--,00:52:35.460,00:52:36.200
"support what are called transactions,
where you can say",00:52:36.200,00:52:38.870
START TRANSACTION literally.,00:52:38.870,00:52:40.990
"You can then execute
two SQL statements.",00:52:40.990,00:52:43.270
"And a SQL statement, as you'll see
in p-set seven, looks a little",00:52:43.270,00:52:45.710
something like this.,00:52:45.710,00:52:46.750
Update a table called account.,00:52:46.750,00:52:48.820
"Set the balance column equal to whatever
the balance column currently",00:52:48.820,00:52:52.550
"is minus 1,000 where the number, the
account number, like the user ID,",00:52:52.550,00:52:57.280
"equals 2, and then update
account dot dot dot.",00:52:57.280,00:53:00.830
"&gt;&gt; So in layman's terms, what do these two
queries seem to be doing in the",00:53:00.830,00:53:04.350
real world sense of banking?,00:53:04.350,00:53:05.840
&gt;&gt; AUDIENCE: Transferring to savings.,00:53:05.840,00:53:07.440
&gt;&gt; DAVID MALAN: Exactly.,00:53:07.440,00:53:08.020
"Transferring funds from one
account to the other.",00:53:08.020,00:53:10.470
"And this is another example where you
really want these two things to happen",00:53:10.470,00:53:14.400
or not happen.,00:53:14.400,00:53:15.570
"You don't want something to get in the
middle of them and potentially mess up",00:53:15.570,00:53:18.880
"the math, or mess up how much
money you have, or how much",00:53:18.880,00:53:22.220
money the bank has.,00:53:22.220,00:53:23.170
"So what's really nice about transactions
in MySQL is that, and",00:53:23.170,00:53:26.890
"databases more generally, is that they
and smart people who've implemented",00:53:26.890,00:53:30.160
"these features figure out how to make
sure that both of those things happen",00:53:30.160,00:53:33.670
or not at all.,00:53:33.670,00:53:35.120
"&gt;&gt; And if you are truly aspiring to make
a website that's used by people on",00:53:35.120,00:53:38.580
"campus, people in the real world, doing
something in the startup sense,",00:53:38.580,00:53:41.490
"these are the kinds of
design decisions that",00:53:41.490,00:53:43.300
become ever so important.,00:53:43.300,00:53:45.020
"Otherwise, you start to lose data, lose
users, or in the worst case as",00:53:45.020,00:53:48.240
"we've seen here, potentially
lose money.",00:53:48.240,00:53:51.800
"So again, more on that in problem set
seven, as well as perhaps for some of",00:53:51.800,00:53:56.180
you in final projects.,00:53:56.180,00:53:57.530
"&gt;&gt; So let's change that picture we had
a moment ago just in one more way.",00:53:57.530,00:54:01.870
So let me actually see if I can--,00:54:01.870,00:54:04.070
"nope, that's gone.",00:54:04.070,00:54:06.030
There it is.,00:54:06.030,00:54:06.690
&gt;&gt; So this is where we left last time.,00:54:06.690,00:54:09.020
"And it turns out we're going to toss
one more thing into the mix here--",00:54:09.020,00:54:12.390
a language called JavaScript.,00:54:12.390,00:54:14.510
"So JavaScript actually fits
into this piece--",00:54:14.510,00:54:18.060
"and I didn't quite leave enough room,
so this is not now to scale.",00:54:18.060,00:54:22.086
"OK, this is really pathetic.",00:54:22.086,00:54:23.900
"OK, so that's JavaScript.",00:54:23.900,00:54:27.075
All right.,00:54:27.075,00:54:27.340
I'm really doing it a disservice.,00:54:27.340,00:54:28.760
All right.,00:54:28.760,00:54:29.390
"&gt;&gt; So JavaScript is another programming
language, and our last, If that helps",00:54:29.390,00:54:34.790
"reassure that there's not much more
of the fire hydrants here.",00:54:34.790,00:54:37.770
"So JavaScript is also an interpreted
language, which means you don't",00:54:37.770,00:54:41.100
compile it into zeros and ones.,00:54:41.100,00:54:42.670
You just run it.,00:54:42.670,00:54:43.690
"But what's fundamentally different with
JavaScript usually is that you",00:54:43.690,00:54:47.680
don't run it on your web server.,00:54:47.680,00:54:49.815
"It doesn't get run in the
appliance per se.",00:54:49.815,00:54:52.570
"Rather, it gets downloaded by a user
via HTTP into their browser--",00:54:52.570,00:54:57.490
"Chrome, Safari, Internet Explorer,
Firefox, whatever--",00:54:57.490,00:55:00.260
"and it's the browser that executes this
particular programming language.",00:55:00.260,00:55:03.860
"&gt;&gt; So to be clear, PHP thus far has been
executed either at the command line in",00:55:03.860,00:55:08.000
"our black and white window, on a server
like the appliance, a computer",00:55:08.000,00:55:11.290
"like the appliance, or it's been
executed by a web server",00:55:11.290,00:55:14.490
running on a computer.,00:55:14.490,00:55:15.860
"But the theme here is that PHP thus far
has been executed server-side, so",00:55:15.860,00:55:20.490
"the user and the user's browser
never sees a line of PHP code.",00:55:20.490,00:55:24.820
"&gt;&gt; In fact, if you ever open a browser for
your website or another and you",00:55:24.820,00:55:28.530
"actually see PHP code in your window,
someone has screwed up.",00:55:28.530,00:55:32.400
"Because it's not meant to be
sent to a browser directly.",00:55:32.400,00:55:34.950
"It's supposed to be executed and turned
into something like HTML.",00:55:34.950,00:55:38.150
"&gt;&gt; But JavaScript is essentially
the opposite.",00:55:38.150,00:55:40.120
"It's meant to be run typically inside
of a user's browser window.",00:55:40.120,00:55:44.350
"And what kinds of websites use
JavaScript then these days?",00:55:44.350,00:55:46.840
&gt;&gt; Like literally every popular website.,00:55:49.640,00:55:52.180
"Every website that you guys probably
use daily use JavaScript for the",00:55:52.180,00:55:55.430
"simplest and even the
sexiest features.",00:55:55.430,00:55:57.330
"&gt;&gt; So something like Facebook
Chat if you use that.",00:55:57.330,00:55:59.800
How does that actually work?,00:55:59.800,00:56:01.040
"Well thus far, all of the stuff we've
done with HTML and PHP assumes that",00:56:01.040,00:56:05.090
"you pull up a URL, and you hit Enter,
and you see some HTML content.",00:56:05.090,00:56:08.750
"And you click the link, that changes the
URL, changes the page, and reloads",00:56:08.750,00:56:11.970
some new content.,00:56:11.970,00:56:12.740
"Click another URL or submit a form, you
get whisked to another page and",00:56:12.740,00:56:16.340
you see some new content.,00:56:16.340,00:56:17.420
"&gt;&gt; But using something like Facebook Chat,
or Gchat, or Google Maps, rarely",00:56:17.420,00:56:22.710
"does the whole page refresh such that
you see a white screen momentarily and",00:56:22.710,00:56:27.350
then new content.,00:56:27.350,00:56:28.470
"Rather, web pages today are dynamically
getting updated again and",00:56:28.470,00:56:32.610
"again and again all sort
of behind the scenes.",00:56:32.610,00:56:35.570
"And it turns out that when you do go to
something like Facebook, or Gchat,",00:56:35.570,00:56:38.560
"or Gmail, and the page updates
automatically without reloading the",00:56:38.560,00:56:43.050
"whole screen, what's happened is that
your browser has made sort of secretly",00:56:43.050,00:56:47.630
additional HTTP requests--,00:56:47.630,00:56:49.410
"not for whole web pages, but just for
little chunks of data, like the",00:56:49.410,00:56:52.740
"instant message that your friend just
sent you, or the status update that",00:56:52.740,00:56:55.740
"someone just sent you, or the tweet
that someone just sent.",00:56:55.740,00:56:58.210
"It's just making little requests for
data, and then using JavaScript, this",00:56:58.210,00:57:02.120
"programming language, to change what
the web page looks like without the",00:57:02.120,00:57:06.370
"server helping, without the server
generating that HTML.",00:57:06.370,00:57:09.860
"&gt;&gt; So in short, JavaScript can be used then
to not only fetch new data from",00:57:09.860,00:57:13.820
"the server without reloading a whole
page or submitting a form.",00:57:13.820,00:57:16.750
"It can also be used to change
the so-called DOM--",00:57:16.750,00:57:20.060
document object model--,00:57:20.060,00:57:21.520
"which is just the fancy way for
saying the tree of HTML",00:57:21.520,00:57:24.620
that we saw last time.,00:57:24.620,00:57:26.220
"&gt;&gt; So to reassure, JavaScript is
syntactically so similar to C as well.",00:57:26.220,00:57:31.640
There's no main function.,00:57:31.640,00:57:32.820
"You just start writing the code
and it will get executed, or",00:57:32.820,00:57:35.430
interpreted more properly.,00:57:35.430,00:57:36.900
Conditions will look like this.,00:57:36.900,00:57:38.660
"No different from C or
PHP for that matter.",00:57:38.660,00:57:41.230
"Boolean expressions or-ed together
will look like this.",00:57:41.230,00:57:43.890
Anded together look like this.,00:57:43.890,00:57:45.590
&gt;&gt; Switches will look like this.,00:57:45.590,00:57:47.750
For loops will look like this.,00:57:47.750,00:57:49.440
While loops will look like this.,00:57:49.440,00:57:51.060
Do while loops will look like this.,00:57:51.060,00:57:53.316
&gt;&gt; This is new.,00:57:53.316,00:57:54.780
"So JavaScript has not a foreach
construct per se, but this construct",00:57:54.780,00:57:58.753
"for variable i in array, and i in this
case becomes an index value.",00:57:58.753,00:58:03.870
"So it's a little different from that
foreach, though new versions of",00:58:03.870,00:58:06.880
"JavaScript are coming out all the time,
so even these language features",00:58:06.880,00:58:10.280
are evolving.,00:58:10.280,00:58:10.880
"&gt;&gt; And as an aside, JavaScript these days
can also be used on a server just like",00:58:10.880,00:58:16.920
PHP using a framework called Node.js.,00:58:16.920,00:58:19.920
"One of CS50's TFs, Kevin, has led a
seminar on Node.js that's available at",00:58:19.920,00:58:24.670
cs50.net/seminars.,00:58:24.670,00:58:26.440
"So if you're curious, know that you
can use this on the server side as",00:58:26.440,00:58:28.830
"well, but that's a fairly recent trend,
but a powerful one at that.",00:58:28.830,00:58:33.870
&gt;&gt; This is a little different.,00:58:33.870,00:58:35.270
This is an array in JavaScript.,00:58:35.270,00:58:37.910
"And what strikes you as different
versus C or PHP?",00:58:37.910,00:58:40.115
"There are a few quick stories
we can tell here.",00:58:43.890,00:58:47.420
What's missing versus PHP?,00:58:47.420,00:58:49.367
&gt;&gt; AUDIENCE: [INAUDIBLE].,00:58:49.367,00:58:51.652
&gt;&gt; DAVID MALAN: Yes?,00:58:51.652,00:58:52.110
"Sorry, say again?",00:58:52.110,00:58:53.322
"&gt;&gt; AUDIENCE: Not declaring
the type of variable.",00:58:53.322,00:58:54.740
"&gt;&gt; DAVID MALAN: We're not declaring
the type of variable.",00:58:54.740,00:58:56.390
"So actually quite like PHP, we're not
specifying the types of this variable.",00:58:56.390,00:58:59.630
"Rather, we're more generically
saying var for variable.",00:58:59.630,00:59:02.670
"We don't have PHP's nuisance of the
dollar sign, which while tedious to",00:59:02.670,00:59:06.690
"type, does make more clear that
something's a variable.",00:59:06.690,00:59:09.160
"Whereas here, we're sort of back to
C's approach by just calling a",00:59:09.160,00:59:11.830
"variable by the name we want
to give it, like numbers.",00:59:11.830,00:59:14.500
"And also like PHP, we have
square brackets for the",00:59:14.500,00:59:17.170
values inside that array.,00:59:17.170,00:59:19.170
"&gt;&gt; So variables in JavaScript also
might look like this.",00:59:19.170,00:59:22.490
"Notice here this is a string called s,
but similarly have we not specified",00:59:22.490,00:59:26.900
that it's a string.,00:59:26.900,00:59:28.750
"Here though is a feature that doesn't
exist in exactly the same way in PHP,",00:59:28.750,00:59:33.160
but a bit similarly.,00:59:33.160,00:59:34.460
This is an object in JavaScript.,00:59:34.460,00:59:36.530
"And objects are sort of the Swiss Army
Knife of a data structure in that you",00:59:36.530,00:59:42.110
can use them for any number of things.,00:59:42.110,00:59:43.900
"&gt;&gt; Here, for instance, we're declaring
a variable called quote.",00:59:43.900,00:59:46.860
"The type of that variable
is an object.",00:59:46.860,00:59:49.110
"You can think of this as a C struct
that has keys and values.",00:59:49.110,00:59:53.550
Symbol is a key.,00:59:53.550,00:59:55.250
"FB is a value, apparently
a stock symbol.",00:59:55.250,00:59:57.350
Comma.,00:59:57.350,00:59:57.930
"Price is another key, and its value is
apparently a floating point, or a",00:59:57.930,01:00:02.180
"number more generally in
JavaScript, of $49.26.",01:00:02.180,01:00:06.510
&gt;&gt; So PHP doesn't have--,01:00:06.510,01:00:09.030
"we haven't seen in PHP objects quite
like this, but we did see an analog,",01:00:09.030,01:00:12.980
which was what?,01:00:12.980,01:00:14.093
&gt;&gt; AUDIENCE: [INAUDIBLE].,01:00:14.093,01:00:14.980
&gt;&gt; DAVID MALAN: Associative arrays.,01:00:14.980,01:00:16.110
"So whereas PHP has associative arrays
whose syntax is ever slightly so",01:00:16.110,01:00:19.990
different--,01:00:19.990,01:00:20.370
we saw the square brackets.,01:00:20.370,01:00:21.780
We saw the weird arrows symbols.,01:00:21.780,01:00:23.860
"JavaScript has objects, but this is
mostly a semantic difference and a",01:00:23.860,01:00:27.330
different synonym for now.,01:00:27.330,01:00:29.260
"However, as an aside, PHP also has
objects in a way that Java and other",01:00:29.260,01:00:35.060
"languages have objects in
object-oriented programming.",01:00:35.060,01:00:37.810
"But we'll use these just
for data types for now.",01:00:37.810,01:00:40.440
Objects and associative arrays.,01:00:40.440,01:00:42.170
"&gt;&gt; This one might make it
a little more clear.",01:00:42.170,01:00:44.140
Here's why an object is useful.,01:00:44.140,01:00:45.890
"When you want to declare a student,
like Zamyla, we can actually",01:00:45.890,01:00:48.760
"encapsulate so to speak inside of that
object using curly brackets just like",01:00:48.760,01:00:52.630
"before a whole bunch of keys
and values in here.",01:00:52.630,01:00:55.060
"We have an ID, a house, and a name for
Zamyla, followed by a semicolon as",01:00:55.060,01:00:59.150
usual at the end.,01:00:59.150,01:01:00.690
"&gt;&gt; Down here too, this is slightly
different, but also very powerful",01:01:00.690,01:01:04.840
these days.,01:01:04.840,01:01:05.690
"Here's an array, and I know that because
there's a square bracket up",01:01:05.690,01:01:08.780
"top and a square bracket
at the bottom.",01:01:08.780,01:01:11.090
"And this is an array of what data
type apparently in JavaScript?",01:01:11.090,01:01:16.050
"This is an array of it looks
like three objects.",01:01:16.050,01:01:21.260
"And I know it's an object only
because of the curly braces.",01:01:21.260,01:01:24.580
"And notice there's open curly brace,
some stuff, close curly brace, comma,",01:01:24.580,01:01:28.760
"then some more, comma,
and then some more.",01:01:28.760,01:01:31.180
"So that's three arguments
separated by two commas.",01:01:31.180,01:01:33.800
&gt;&gt; So this is an array of three objects.,01:01:33.800,01:01:36.810
"And each of those objects appears to be
a student or staff member of some",01:01:36.810,01:01:39.940
"sort, each with an ID,
house, and name.",01:01:39.940,01:01:42.370
"But I've called this something
called JSON--",01:01:42.370,01:01:45.060
JavaScript Object Notation.,01:01:45.060,01:01:47.450
"And this is a data format that actually
is so very popular and in",01:01:47.450,01:01:52.060
"vogue these days that if you write an
application that uses the Facebook",01:01:52.060,01:01:55.100
"API, the Twitter API, really almost
any API out there these days,",01:01:55.100,01:01:59.150
"including some of CS50's own, the
data you get back is not in",01:01:59.150,01:02:02.820
old school CSV format.,01:02:02.820,01:02:04.720
"&gt;&gt; Because recall that CSV
is super simple.",01:02:04.720,01:02:06.780
"It is just columns separated
by commas.",01:02:06.780,01:02:10.230
JSON data gives you more metadata.,01:02:10.230,01:02:13.190
"It associates a key with every value so
they don't have to just assume that",01:02:13.190,01:02:17.800
"the zeroth column is one value, column
one is another, column two is another.",01:02:17.800,01:02:22.460
"Everything in a JSON object here is sort
of self-describing, because every",01:02:22.460,01:02:26.790
"one of names in this file has literally
name in front of it as a",01:02:26.790,01:02:30.940
quoted string.,01:02:30.940,01:02:32.510
"&gt;&gt; So let's take a look at a
couple of examples here.",01:02:32.510,01:02:34.950
Let me go into the appliance.,01:02:34.950,01:02:36.800
"And let me go into our vhost
directory into public.",01:02:36.800,01:02:41.000
"And let me go into the
JavaScript directory.",01:02:41.000,01:02:45.590
"And let's go ahead and open up
dom-0.html, where DOM just means",01:02:45.590,01:02:49.610
document object model.,01:02:49.610,01:02:51.010
"It's the tree stuff to which
I referred to earlier.",01:02:51.010,01:02:53.490
&gt;&gt; And let me propose the following.,01:02:53.490,01:02:54.950
"Here's a web page whose
body is pretty simple.",01:02:54.950,01:02:57.720
"So down here at the bottom,
notice I have a form.",01:02:57.720,01:03:00.170
We've seen those before.,01:03:00.170,01:03:01.500
"It has two inputs, one of which has an
ID of name, one of which has a type of",01:03:01.500,01:03:07.600
"submit, and the first
one's type is text.",01:03:07.600,01:03:09.830
So this actually sounds pretty simple.,01:03:09.830,01:03:11.900
&gt;&gt; Let's go here.,01:03:11.900,01:03:13.090
Let's go back to this page here.,01:03:13.090,01:03:15.390
"Let's go into localhost, and go into
our JavaScript directory, and go to",01:03:15.390,01:03:21.030
"dom-0, and here we have this form.",01:03:21.030,01:03:24.640
"So that's apparently
all this page does.",01:03:24.640,01:03:26.550
"It has a name field with
a Submit button.",01:03:26.550,01:03:28.740
But I'm not going to use PHP here.,01:03:28.740,01:03:30.340
"I'm going to do everything client side
so to speak in JavaScript as follows.",01:03:30.340,01:03:34.310
"&gt;&gt; Notice that I've indeed given the name
field of this input a unique",01:03:34.310,01:03:39.100
"identifier, which will actually
save me some time in a moment.",01:03:39.100,01:03:42.350
"And notice I've introduced another tag
in the head of my web page, the",01:03:42.350,01:03:45.480
 tag.,01:03:45.480,01:03:46.565
"&gt;&gt; So it's in this sense that JavaScript is
a client-side programming language.",01:03:46.565,01:03:50.120
"In this case, just like CSS, I've put
it straight inside of my HTML.",01:03:50.120,01:03:55.020
"But notice I've declared a function
that looks a little like PHP",01:03:55.020,01:03:58.810
"syntactically, but this is actually
JavaScript, because again, it's",01:03:58.810,01:04:01.530
client-side in the browser.,01:04:01.530,01:04:03.920
"And take a guess what this is going to
do, even though some of the syntax",01:04:03.920,01:04:07.590
here is new.,01:04:07.590,01:04:09.338
&gt;&gt; AUDIENCE: Say hello to whoever.,01:04:09.338,01:04:11.760
"&gt;&gt; DAVID MALAN: It's going to say hello
to whoever visits this page.",01:04:11.760,01:04:14.020
So how?,01:04:14.020,01:04:15.120
"&gt;&gt; So notice, it turns out in JavaScript
there's an alert() function.",01:04:15.120,01:04:18.070
"This is a very sort of sad function that
really just tends to annoy users.",01:04:18.070,01:04:22.840
"It's not one you should really use
typically, but it's a quick and dirty",01:04:22.840,01:04:25.440
"way of sort of printing something
to a graphical user",01:04:25.440,01:04:27.710
"interface, like a browser.",01:04:27.710,01:04:29.180
"Notice here that I've got a
string in single quotes.",01:04:29.180,01:04:31.400
"It turns out that unlike C, JavaScript
can actually have you use single",01:04:31.400,01:04:36.010
"quotes, and frankly it's just kind
of the stylistic convention among",01:04:36.010,01:04:38.730
"JavaScript programmers
to use single quotes.",01:04:38.730,01:04:41.180
"PHP, they actually have slightly
different meaning.",01:04:41.180,01:04:43.750
"But for now, just know that
that's the only reason.",01:04:43.750,01:04:45.810
"The convention in JavaScript is often to
use single quotes, but we could use",01:04:45.810,01:04:49.270
double quotes in both places as well.,01:04:49.270,01:04:50.950
&gt;&gt; So this is interesting.,01:04:50.950,01:04:52.610
"Recall last time that we had that
picture on the screen that drew a tree",01:04:52.610,01:04:56.430
"where you had the HTML node, and the
head node, and the body node,",01:04:56.430,01:04:59.720
and then some text.,01:04:59.720,01:05:00.800
"But there was one special node at the
very top that I called the document.",01:05:00.800,01:05:04.700
"Well, it turns out in JavaScript, any
time you write a program in JavaScript",01:05:04.700,01:05:08.260
"in a browser, you have access to
a special global variable.",01:05:08.260,01:05:11.040
"Similar in spirit to PHP's superglobals,
this one is called in",01:05:11.040,01:05:14.130
all lowercase document.,01:05:14.130,01:05:16.050
"&gt;&gt; It's like a struct, but this struct
also has functions inside of it.",01:05:16.050,01:05:21.480
So a C struct just has data typically.,01:05:21.480,01:05:23.790
"But a JavaScript object as this
technically is also has functions,",01:05:23.790,01:05:29.060
"otherwise known as methods,
inside of it.",01:05:29.060,01:05:31.830
"And you can call a function inside of
this object quite literally doing its",01:05:31.830,01:05:35.750
"name, dot, and then the name of
the function, or again method.",01:05:35.750,01:05:39.610
"It's just a synonym, really.",01:05:39.610,01:05:41.160
&gt;&gt; And what does this function do?,01:05:41.160,01:05:42.450
You can kind of guess from its name.,01:05:42.450,01:05:43.840
Get element by ID.,01:05:43.840,01:05:45.590
"So this is going to search the web page,
search that tree, looking for",01:05:45.590,01:05:50.040
"whatever node, AKA element, has a
unique ID of quote unquote name.",01:05:50.040,01:05:55.210
And then what am I going to do?,01:05:55.210,01:05:56.560
"I'm going to get the value inside of
that node in the tree, and I'm going",01:05:56.560,01:06:00.350
to somehow say hello to that name.,01:06:00.350,01:06:02.580
"&gt;&gt; So take a guess, even though we've not
seen this yet, what do the plus",01:06:02.580,01:06:05.360
symbols mean here and here probably?,01:06:05.360,01:06:07.396
&gt;&gt; AUDIENCE: Concatenate.,01:06:07.396,01:06:08.230
&gt;&gt; DAVID MALAN: Concatenate.,01:06:08.230,01:06:09.220
"Right, and these are just
sort of design decisions",01:06:09.220,01:06:11.290
people made years ago.,01:06:11.290,01:06:12.280
"In PHP, you concatenate
things with dots.",01:06:12.280,01:06:15.190
"In C, you jump through several hoops and
call functions like strcopy() or",01:06:15.190,01:06:18.800
strcat() or other such functions.,01:06:18.800,01:06:20.600
"But in JavaScript, you use pluses.",01:06:20.600,01:06:22.060
"So this is just concatenating
three strings--",01:06:22.060,01:06:24.770
"hello, a name, and then
an exclamation point.",01:06:24.770,01:06:27.850
"&gt;&gt; So when and why is this function
called though?",01:06:27.850,01:06:30.390
"Well, take a guess from the
HTML at the bottom.",01:06:30.390,01:06:33.150
"Why is greet() called, or when?",01:06:33.150,01:06:35.810
"&gt;&gt; Apparently, as best I can tell, on
submit, when this form is submitted,",01:06:39.730,01:06:44.030
"I'm going to do whatever is
inside of these quotes.",01:06:44.030,01:06:47.200
"And specifically, I'm going to call
greet() and then return false.",01:06:47.200,01:06:50.900
"&gt;&gt; Well, let's see what the net
effect here is first.",01:06:50.900,01:06:53.090
"So let me go ahead and type
in, say, Loren, Submit.",01:06:53.090,01:06:58.290
Hello Loren.,01:06:58.290,01:06:59.440
"Let's see if maybe this was just
a lucky implementation.",01:06:59.440,01:07:02.990
Nope.,01:07:02.990,01:07:03.200
"So it's typing out whatever
name I actually put there.",01:07:03.200,01:07:05.990
&gt;&gt; But notice what's not changing.,01:07:05.990,01:07:07.970
The URL is still dom-0.html.,01:07:07.970,01:07:10.360
There's no register.php.,01:07:10.360,01:07:11.820
There's no second file.,01:07:11.820,01:07:13.110
There's no action attribute.,01:07:13.110,01:07:14.930
"So what is this return false
presumably doing?",01:07:14.930,01:07:19.720
"Why am I calling greet() and then
returning false probably?",01:07:19.720,01:07:23.660
"What normally happens when you click
Submit on a form that even we have",01:07:23.660,01:07:26.420
seen in the past week?,01:07:26.420,01:07:27.854
&gt;&gt; AUDIENCE: [INAUDIBLE].,01:07:27.854,01:07:29.900
"&gt;&gt; DAVID MALAN: It goes somewhere, right?",01:07:29.900,01:07:30.860
It goes to some destination URL.,01:07:30.860,01:07:32.720
But I don't want that to happen here.,01:07:32.720,01:07:34.120
"I want my web page to be completely
dynamic like Gmail, where once you're",01:07:34.120,01:07:37.620
"there, you stay there.",01:07:37.620,01:07:38.650
"The URL doesn't change in a way that
indicates the whole page is reloading.",01:07:38.650,01:07:42.900
"Rather, I just want to change something
like printing out something",01:07:42.900,01:07:46.680
here on the screen.,01:07:46.680,01:07:48.320
"&gt;&gt; Well let me clean this
up a little bit.",01:07:48.320,01:07:49.630
"Let me open up not dom-0, but
let me open up dom-2.",01:07:49.630,01:07:55.370
Just so you've seen some syntax here.,01:07:55.370,01:07:57.350
"&gt;&gt; It turns out that what we just
did is using raw JavaScript.",01:07:57.350,01:08:02.080
"So this is truly the language
JavaScript.",01:08:02.080,01:08:04.420
"Some of you might know of
a library called jQuery.",01:08:04.420,01:08:07.340
"&gt;&gt; So jQuery is not the same
thing as JavaScript.",01:08:07.340,01:08:09.980
"It's just a library that a really smart
guy wrote and popularized such",01:08:09.980,01:08:14.110
"that almost everyone in the world now
uses jQuery when using JavaScript.",01:08:14.110,01:08:18.100
"And at first glance, honestly, it
looks a little more cryptic.",01:08:18.100,01:08:20.890
"But you'll find, especially if you go
there for your final project with web",01:08:20.890,01:08:24.990
"development, you'll find that this
cleans things up and saves you quite a",01:08:24.990,01:08:29.029
few lines of code.,01:08:29.029,01:08:30.229
"&gt;&gt; So let's just glance at how
this form is working.",01:08:30.229,01:08:33.189
"Notice what did I remove apparently
from my HTML?",01:08:33.189,01:08:35.664
"There's no on submit handler
so to speak.",01:08:38.240,01:08:40.630
There's no attribute.,01:08:40.630,01:08:41.470
"Because you know, what
I didn't really like?",01:08:41.470,01:08:43.359
"I felt like we were falling
into old habits there.",01:08:43.359,01:08:45.640
"Just like it was starting to feel sloppy
to intermingle both CSS with",01:08:45.640,01:08:49.340
"HTML, because you're kind of throwing
different languages all over the",01:08:49.340,01:08:52.149
"place, similarly did this start to feel
like a bad road to go down where",01:08:52.149,01:08:56.180
"I'm putting JavaScript code inside of my
HTML rather than factoring it out.",01:08:56.180,01:09:01.069
&gt;&gt; So that's the lesson here.,01:09:01.069,01:09:02.279
"In dom-2.html, I'm factoring it out.",01:09:02.279,01:09:05.080
"And I'm doing things slightly
differently.",01:09:05.080,01:09:07.399
"For now, I'm going to wave my hands
at what this really does",01:09:07.399,01:09:09.630
underneath the hood.,01:09:09.630,01:09:10.590
"But just for now assume that that first
line of code in this library",01:09:10.590,01:09:14.210
"called jQuery just means when the
document is ready, do the following.",01:09:14.210,01:09:18.170
"&gt;&gt; Because web pages can take
some time to load.",01:09:18.170,01:09:20.080
"You might be on a slow internet
connection, and it might be spinning",01:09:20.080,01:09:23.029
"and spinning, and finally it's loaded.",01:09:23.029,01:09:25.290
"That line of code just says wait until
the whole page is ready, the document",01:09:25.290,01:09:29.060
"is ready, before executing this code.",01:09:29.060,01:09:31.189
"&gt;&gt; And now notice, this is probably
the most useful first",01:09:31.189,01:09:34.390
take away from jQuery.,01:09:34.390,01:09:36.189
"This line here is very similar in spirit
to this much longer line here.",01:09:36.189,01:09:42.140
"Whereas in raw JavaScript code, there
exists a document global object that",01:09:42.140,01:09:46.920
"has a function called getElementById(),
the people who wrote",01:09:46.920,01:09:50.460
"jQuery simplified that to just say
dollar sign, and then inside of",01:09:50.460,01:09:55.720
"parentheses put two quotes, and then
put a hash symbol followed by the",01:09:55.720,01:10:00.250
unique ID you want to grab.,01:10:00.250,01:10:02.250
"So this is equivalent to
document.getElementById.",01:10:02.250,01:10:06.170
"&gt;&gt; Meanwhile, .submit just means on
submission of whatever form you're",01:10:06.170,01:10:11.090
"referring to on the left, go
ahead and execute this.",01:10:11.090,01:10:14.240
But this is now the curiosity too.,01:10:14.240,01:10:16.600
"What's weird about what
I've highlighted here?",01:10:16.600,01:10:19.560
"Not only is it kind of syntactically
new, there's also something missing.",01:10:23.840,01:10:28.594
&gt;&gt; AUDIENCE: It's just called function?,01:10:28.594,01:10:29.558
It's not called alert?,01:10:29.558,01:10:31.970
&gt;&gt; DAVID MALAN: Yeah.,01:10:31.970,01:10:32.440
"Well, so alert() is down
here, to be fair.",01:10:32.440,01:10:35.450
"But there is no mention of a
name, like you know, foo or",01:10:35.450,01:10:39.520
something up here.,01:10:39.520,01:10:40.980
"And indeed, this is one of the features
of JavaScript that's quite",01:10:40.980,01:10:43.830
"powerful, but also quite new.",01:10:43.830,01:10:45.370
And PHP actually has this as well.,01:10:45.370,01:10:47.460
"&gt;&gt; Let me go ahead and do
something real quick.",01:10:47.460,01:10:49.500
Let me go ahead and put this out here.,01:10:49.500,01:10:52.030
Let me do this.,01:10:52.030,01:10:52.600
Function.,01:10:52.600,01:10:53.690
Let's call this handler().,01:10:53.690,01:10:56.455
A handler function so to speak.,01:10:56.455,01:10:58.290
Something that handles some operation.,01:10:58.290,01:11:00.110
Let me clean up my indentation.,01:11:00.110,01:11:02.700
And put this here.,01:11:02.700,01:11:04.380
And put that here.,01:11:04.380,01:11:06.090
Yep.,01:11:06.090,01:11:06.470
OK.,01:11:06.470,01:11:07.060
"&gt;&gt; So now I have a function called
handler() that I don't really know",01:11:07.060,01:11:10.300
what it does yet.,01:11:10.300,01:11:10.890
It just still has that stuff.,01:11:10.890,01:11:12.710
Whoops.,01:11:12.710,01:11:13.900
Took too much.,01:11:13.900,01:11:15.820
Let's do this.,01:11:15.820,01:11:18.490
All right.,01:11:18.490,01:11:18.990
Sorry.,01:11:18.990,01:11:20.240
All right.,01:11:23.140,01:11:23.690
Let me do this.,01:11:23.690,01:11:24.720
OK.,01:11:24.720,01:11:25.020
"That looks nice and straight
forward now.",01:11:25.020,01:11:27.040
Let me do this.,01:11:27.040,01:11:29.090
Do this.,01:11:29.090,01:11:29.860
And OK.,01:11:29.860,01:11:30.950
"So now, let's put this over here.",01:11:30.950,01:11:33.080
No more programming on the fly.,01:11:35.840,01:11:37.270
OK.,01:11:37.270,01:11:37.900
"&gt;&gt; So now, let's go back to
where the story began.",01:11:37.900,01:11:40.000
"Previously, I said that this line here
means when the document is ready, go",01:11:40.000,01:11:43.530
ahead and do this.,01:11:43.530,01:11:44.380
What do I want to do?,01:11:44.380,01:11:45.660
"Well specifically, I want to go
ahead and do the following.",01:11:45.660,01:11:49.070
"Execute this line of code, and then
what I want you to do is call this",01:11:49.070,01:11:53.700
function when the form is submitted.,01:11:53.700,01:11:56.370
&gt;&gt; Now this is what's interesting.,01:11:56.370,01:11:57.730
This is not itself a function.,01:11:57.730,01:11:59.170
"Notice I am not putting parentheses
here in the normal way.",01:11:59.170,01:12:02.540
"I'm literally passing a function called
handler() to another function",01:12:02.540,01:12:06.800
"called submit() as an argument as
though it's like a variable.",01:12:06.800,01:12:10.800
"And this is one of the features of
JavaScript, is functions themselves",01:12:10.800,01:12:14.290
are really just objects.,01:12:14.290,01:12:15.710
"In fact, they're really just
variables of some sort.",01:12:15.710,01:12:18.350
"And if the name of the function is
handler(), there is no reason I can't",01:12:18.350,01:12:21.340
pass it in as an argument here.,01:12:21.340,01:12:23.390
"And this means when the form
with the ID of demo is",01:12:23.390,01:12:27.530
"submitted, call this function.",01:12:27.530,01:12:29.320
"&gt;&gt; But now if I undo all of this,
why then did I perhaps do",01:12:29.320,01:12:32.770
this a moment ago?,01:12:32.770,01:12:34.850
"Well, this is an anonymous function.",01:12:34.850,01:12:36.840
"Because frankly, I realized why am I
bothering to waste time declaring a",01:12:36.840,01:12:41.080
"function called handler() only to call
it in one and only one place?",01:12:41.080,01:12:45.540
"If I don't need the name, and I don't
need to call it more than one place,",01:12:45.540,01:12:48.640
"let's just implement the function
right where I need it.",01:12:48.640,01:12:51.200
"And so JavaScript and PHP support what
are called anonymous functions that",01:12:51.200,01:12:55.190
allow me to do exactly that here.,01:12:55.190,01:12:57.900
&gt;&gt; But we're just scratching the surface.,01:12:57.900,01:12:59.570
"Let's tease with just a couple
final examples here.",01:12:59.570,01:13:02.430
&gt;&gt; If I go into quote.php.,01:13:02.430,01:13:04.600
"Notice that this is actually a PHP
function, a PHP program, that I wrote",01:13:07.160,01:13:11.870
"that expects an HTTP parameter called
symbol, and I can pass in",01:13:11.870,01:13:15.270
a value like FB.,01:13:15.270,01:13:16.730
"And if we actually look at the source
code, this is querying a free website",01:13:16.730,01:13:20.010
"called Yahoo Finance, just like p-set
seven, and it's returning to me",01:13:20.010,01:13:23.680
"something in apparently the
format known is JSON--",01:13:23.680,01:13:26.580
JavaScript Object Notation.,01:13:26.580,01:13:28.010
It's just an object.,01:13:28.010,01:13:28.810
"Notice the curly braces, the quotes,
the colon, and the commas.",01:13:28.810,01:13:32.500
"&gt;&gt; Now meanwhile, this is pretty cool.",01:13:32.500,01:13:34.720
"Because I can probably use a programming
language to generate URLs",01:13:34.720,01:13:38.520
"that look like this dynamically,
right?",01:13:38.520,01:13:40.370
"I can change this to Google
and get back Google's",01:13:40.370,01:13:43.340
"stock price of $1,017.55.",01:13:43.340,01:13:47.930
So let's see if we can't use this now.,01:13:47.930,01:13:49.640
"&gt;&gt; Let me go to ajax-0 here, which
looks like the following.",01:13:49.640,01:13:56.590
"It's just a website that has
a form with a button.",01:13:56.590,01:13:59.750
"Let me here go ahead and type in YHOO
for Yahoo's stock symbol, click Get",01:13:59.750,01:14:05.860
"Quote, and now notice I've gotten
an alert with 32.86.",01:14:05.860,01:14:10.530
"&gt;&gt; Let me actually go to a fancier version
of this page, version two, and",01:14:10.530,01:14:14.050
"type in let's say Microsoft, MSFT.",01:14:14.050,01:14:17.530
Get Quote.,01:14:17.530,01:14:18.410
"And now notice, no alert.",01:14:18.410,01:14:19.850
"Notice where it says price
to be determined?",01:14:19.850,01:14:22.770
"There is the simplest of examples that
hints at what Gchat, and Facebook",01:14:22.770,01:14:27.060
"Chat, and Gmail, and other such
websites are doing by actually",01:14:27.060,01:14:30.070
changing the web page.,01:14:30.070,01:14:31.290
&gt;&gt; Notice this.,01:14:31.290,01:14:31.800
Let me reload the page.,01:14:31.800,01:14:33.120
Let me open up Chrome's Inspector.,01:14:33.120,01:14:35.080
"Let me go to the elements
tab down here.",01:14:35.080,01:14:36.890
"Now notice if I zoom in down here and
open this up, notice that this is my",01:14:36.890,01:14:42.310
HTML DOM-- my document object model.,01:14:42.310,01:14:44.500
This is my HTML.,01:14:44.500,01:14:45.920
"But now notice, even though it's going
to be a little hard to see it in both",01:14:45.920,01:14:48.750
"places at once, if I type in FB
up here, watch the bottom",01:14:48.750,01:14:52.080
of the screen only.,01:14:52.080,01:14:54.110
"&gt;&gt; It's actually changing
my HTML on the fly.",01:14:54.110,01:14:57.720
"And it's doing this quite simply
by doing something like this.",01:14:57.720,01:15:01.670
"If I open up ajax-2, notice implementing
something as sexy as",01:15:01.670,01:15:06.800
"that, even though it's pretty ugly,
but as sophisticated as that",01:15:06.800,01:15:09.560
"functionally, it has some
HTML at the bottom.",01:15:09.560,01:15:11.910
But notice I used to  tag.,01:15:11.910,01:15:13.810
"We've not used this before, but this is
like a , but it doesn't force",01:15:13.810,01:15:16.640
everything onto a new line.,01:15:16.640,01:15:17.840
"It just makes a rectangular region
on the same line essentially.",01:15:17.840,01:15:20.830
&gt;&gt; Notice that I gave it an ID of price.,01:15:20.830,01:15:22.870
"And it turns out by using the same
JavaScript library, I have a function",01:15:22.870,01:15:26.800
"called quote() that's called whenever
the form is submitted.",01:15:26.800,01:15:30.440
And what I'm doing is this.,01:15:30.440,01:15:31.800
"I'm declaring a variable in JavaScript
called url, saving the value",01:15:31.800,01:15:35.730
quote.php?symbol=.,01:15:35.730,01:15:38.650
"In other words, I myself am beginning
to prepare an HTTP request, and then",01:15:38.650,01:15:44.220
"I'm concatenating onto that with a plus
whatever the element with the ID",01:15:44.220,01:15:49.250
"of symbol is, which notice is that
text field right down here.",01:15:49.250,01:15:54.190
So just like we had forms in the past.,01:15:54.190,01:15:56.630
"&gt;&gt; And then it turns out in jQuery, if you
call .val(), that calls of a val",01:15:56.630,01:16:01.450
"function, a value function, that gets
whatever the user has typed in.",01:16:01.450,01:16:05.900
"And then all of the network traffic
that happens is this.",01:16:05.900,01:16:08.920
$.getJSON.,01:16:08.920,01:16:11.230
"&gt;&gt; And as an aside, dollar sign is
just a shorthand notation.",01:16:11.230,01:16:13.720
It's really jQuery.getJSON.,01:16:13.720,01:16:16.860
"Get me to JSON from this URL, and when
the request comes back, call this",01:16:16.860,01:16:21.520
"function and pass in as the argument
whatever came back from the server.",01:16:21.520,01:16:26.550
"&gt;&gt; So in other words, if I go back to the
browser, and I go back to quote.php,",01:16:26.550,01:16:31.205
"what my browser is doing is getting
this chunk of data.",01:16:31.205,01:16:35.590
"And when I go to this web page here,
notice if we instead go to the network",01:16:35.590,01:16:38.930
"tab and clear it, and then type in
something like GOOG for Google and Get",01:16:38.930,01:16:43.820
"Quote, notice the page didn't change.",01:16:43.820,01:16:46.340
"But an HTTP request was made, and what
came back here if we look at the",01:16:46.340,01:16:50.990
"response is a whole bunch of JSON
that we accessed finally with",01:16:50.990,01:16:56.130
this simple line here.,01:16:56.130,01:16:58.070
"&gt;&gt; Data is what was gotten
from the server.",01:16:58.070,01:17:00.150
"Price is the name of the
key I care about.",01:17:00.150,01:17:02.120
So data.price gives me that.,01:17:02.120,01:17:05.230
"&gt;&gt; Now meanwhile, and this
is the last example.",01:17:05.230,01:17:07.540
You can do yet more with the page.,01:17:07.540,01:17:09.280
"One actually, well two.",01:17:09.280,01:17:12.440
"We can bring back the 
tag, if you remember this.",01:17:12.440,01:17:14.780
That's JavaScript.,01:17:14.780,01:17:15.850
We can do that.,01:17:15.850,01:17:17.110
Very exciting.,01:17:17.110,01:17:17.690
We'll leave that as a cliffhanger.,01:17:17.690,01:17:18.800
"&gt;&gt; But more excitingly, you can
do things like this.",01:17:18.800,01:17:21.590
"If I go to geolocation-1, it turns out
that Chrome knows that we are at",01:17:21.590,01:17:25.940
latitude longitude 42.37 .-71.10.,01:17:25.940,01:17:30.672
"So there's even more there
at your disposal.",01:17:30.672,01:17:32.940
But more on that next week.,01:17:32.940,01:17:34.290
See you Monday.,01:17:34.290,01:17:35.540
